--[[
          _____                    _____                    _____                _____                    _____                    _____          
         /\    \                  /\    \                  /\    \              /\    \                  /\    \                  /\    \         
        /::\____\                /::\    \                /::\____\            /::\    \                /::\    \                /::\    \        
       /:::/    /               /::::\    \              /::::|   |            \:::\    \              /::::\    \               \:::\    \       
      /:::/    /               /::::::\    \            /:::::|   |             \:::\    \            /::::::\    \               \:::\    \      
     /:::/    /               /:::/\:::\    \          /::::::|   |              \:::\    \          /:::/\:::\    \               \:::\    \     
    /:::/____/               /:::/__\:::\    \        /:::/|::|   |               \:::\    \        /:::/__\:::\    \               \:::\    \    
   /::::\    \              /::::\   \:::\    \      /:::/ |::|   |               /::::\    \      /::::\   \:::\    \              /::::\    \   
  /::::::\    \   _____    /::::::\   \:::\    \    /:::/  |::|   | _____        /::::::\    \    /::::::\   \:::\    \    ____    /::::::\    \  
 /:::/\:::\    \ /\    \  /:::/\:::\   \:::\    \  /:::/   |::|   |/\    \      /:::/\:::\    \  /:::/\:::\   \:::\    \  /\   \  /:::/\:::\    \ 
/:::/  \:::\    /::\____\/:::/__\:::\   \:::\____\/:: /    |::|   /::\____\    /:::/  \:::\____\/:::/  \:::\   \:::\____\/::\   \/:::/  \:::\____\
\::/    \:::\  /:::/    /\:::\   \:::\   \::/    /\::/    /|::|  /:::/    /   /:::/    \::/    /\::/    \:::\  /:::/    /\:::\  /:::/    \::/    /
 \/____/ \:::\/:::/    /  \:::\   \:::\   \/____/  \/____/ |::| /:::/    /   /:::/    / \/____/  \/____/ \:::\/:::/    /  \:::\/:::/    / \/____/ 
          \::::::/    /    \:::\   \:::\    \              |::|/:::/    /   /:::/    /                    \::::::/    /    \::::::/    /          
           \::::/    /      \:::\   \:::\____\             |::::::/    /   /:::/    /                      \::::/    /      \::::/____/           
           /:::/    /        \:::\   \::/    /             |:::::/    /    \::/    /                       /:::/    /        \:::\    \           
          /:::/    /          \:::\   \/____/              |::::/    /      \/____/                       /:::/    /          \:::\    \          
         /:::/    /            \:::\    \                  /:::/    /                                    /:::/    /            \:::\    \         
        /:::/    /              \:::\____\                /:::/    /                                    /:::/    /              \:::\____\        
        \::/    /                \::/    /                \::/    /                                     \::/    /                \::/    /        
         \/____/                  \/____/                  \/____/                                       \/____/                  \/____/         
                                                                                                                                                  
          _____                    _____                    _____                    _____                    _____            _____              
         /\    \                  /\    \                  /\    \                  /\    \                  /\    \          /\    \             
        /::\    \                /::\____\                /::\____\                /::\    \                /::\____\        /::\    \            
       /::::\    \              /:::/    /               /::::|   |               /::::\    \              /:::/    /       /::::\    \           
      /::::::\    \            /:::/    /               /:::::|   |              /::::::\    \            /:::/    /       /::::::\    \          
     /:::/\:::\    \          /:::/    /               /::::::|   |             /:::/\:::\    \          /:::/    /       /:::/\:::\    \         
    /:::/__\:::\    \        /:::/    /               /:::/|::|   |            /:::/  \:::\    \        /:::/    /       /:::/__\:::\    \        
   /::::\   \:::\    \      /:::/    /               /:::/ |::|   |           /:::/    \:::\    \      /:::/    /       /::::\   \:::\    \       
  /::::::\   \:::\    \    /:::/    /      _____    /:::/  |::|   | _____    /:::/    / \:::\    \    /:::/    /       /::::::\   \:::\    \      
 /:::/\:::\   \:::\ ___\  /:::/____/      /\    \  /:::/   |::|   |/\    \  /:::/    /   \:::\ ___\  /:::/    /       /:::/\:::\   \:::\    \     
/:::/__\:::\   \:::|    ||:::|    /      /::\____\/:: /    |::|   /::\____\/:::/____/     \:::|    |/:::/____/       /:::/__\:::\   \:::\____\    
\:::\   \:::\  /:::|____||:::|____\     /:::/    /\::/    /|::|  /:::/    /\:::\    \     /:::|____|\:::\    \       \:::\   \:::\   \::/    /    
 \:::\   \:::\/:::/    /  \:::\    \   /:::/    /  \/____/ |::| /:::/    /  \:::\    \   /:::/    /  \:::\    \       \:::\   \:::\   \/____/     
  \:::\   \::::::/    /    \:::\    \ /:::/    /           |::|/:::/    /    \:::\    \ /:::/    /    \:::\    \       \:::\   \:::\    \         
   \:::\   \::::/    /      \:::\    /:::/    /            |::::::/    /      \:::\    /:::/    /      \:::\    \       \:::\   \:::\____\        
    \:::\  /:::/    /        \:::\__/:::/    /             |:::::/    /        \:::\  /:::/    /        \:::\    \       \:::\   \::/    /        
     \:::\/:::/    /          \::::::::/    /              |::::/    /          \:::\/:::/    /          \:::\    \       \:::\   \/____/         
      \::::::/    /            \::::::/    /               /:::/    /            \::::::/    /            \:::\    \       \:::\    \             
       \::::/    /              \::::/    /               /:::/    /              \::::/    /              \:::\____\       \:::\____\            
        \::/____/                \::/____/                \::/    /                \::/____/                \::/    /        \::/    /            
         ~~                       ~~                       \/____/                  ~~                       \/____/          \/____/             
                                                                                                                                                  
--]]
--ver. 0.1a

if myHero.charName ~= "Renekton" and myHero.charName ~= "JarvanIV" and myHero.charName ~= "Talon" then
  return
end

assert(load(Base64Decode("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"), nil, "bt", _ENV))()
TrackerLoad("bNTChEkQRfdsKYLn")

local version = "0.1a"
local scriptname = "Hentai Bundle"
local developer = "remembermyhentai"
local contact = "skype xd_kikass"

local ATTACKED = false

local FONTAN = false
local lowBase = {["x"] = 406, ["z"] = 424}
local upBase = {["x"] = 14322, ["z"] = 14394}
local REGEN = false
local POTS = {"ItemCrystalFlask", "RegenerationPotion", "ItemMiniRegenPotion", "ItemCrystalFlaskJungle", "ItemDarkCrystalFlask"}
local YOLO = {}

function CheckFountain()
  if not GetGame().map.index == 15 then return end
  if myHero.team == 100 then
    local rastoyanieDown = math.sqrt((myHero.x-lowBase.x)*(myHero.x-lowBase.x) + (myHero.z-lowBase.z)*(myHero.z-lowBase.z))
    if rastoyanieDown < 900 then
      FONTAN = true
    else
      FONTAN = false
    end
  elseif myHero.team == 200 then
    local rastoyanieUp = math.sqrt((myHero.x-upBase.x)*(myHero.x-upBase.x) + (myHero.z-upBase.z)*(myHero.z-upBase.z))
    if rastoyanieUp < 900 then
      FONTAN = true
    else
      FONTAN = false
    end
  end
end

local SMITELIST = {"summonersmite", "s5_summonersmiteplayerganker", "s5_summonersmiteduel"}
local SMITEFOCUS = {"SRU_Blue1.1.1", "SRU_Blue7.1.1", "SRU_Murkwolf2.1.1", "SRU_Murkwolf8.1.1", "SRU_Gromp13.1.1", "SRU_Gromp14.1.1", "Sru_Crab16.1.1", 
"Sru_Crab15.1.1", "SRU_Red10.1.1", "SRU_Red4.1.1", "SRU_Krug11.1.2", "SRU_Krug5.1.2", "SRU_Razorbeak9.1.1", "SRU_Razorbeak3.1.1", "SRU_Dragon6.1.1", 
"SRU_Baron12.1.1", "TT_NWraith1.1.1", "TT_NGolem2.1.1", "TT_NWolf3.1.1", "TT_NWraith4.1.1", "TT_NGolem5.1.1", "TT_NWolf6.1.1", "TT_Spiderboss8.1.1"}
local SMITE, ATTACKSMITE = false

function CastSmite(target)
  if CanCast(SMITESLOT) then
    CastSpell(SMITESLOT, target)
  end
end

function GetAttackSmiteDamage(unit)
  if SMITE and ATTACKSMITE then
    SmiteDmg = 20 + 8*myHero.level
    return SmiteDmg
  end
end

function GetSmiteDamage(unit)
  if SMITE then
    local SmiteDamage
    if myHero.level <= 4 then
      SmiteDamage = 370 + (myHero.level*20)
    end
    if myHero.level > 4 and myHero.level <= 9 then
      SmiteDamage = 330 + (myHero.level*30)
    end
    if myHero.level > 9 and myHero.level <= 14 then
      SmiteDamage = 240 + (myHero.level*40)
    end
    if myHero.level > 14 then
      SmiteDamage = 100 + (myHero.level*50)
    end
    return SmiteDamage
  end
end

function GetSmiteSlot()
  for i=1, 3 do
    if FindSlotByName(SMITELIST[i]) ~= nil then
      SMITESLOT = FindSlotByName(SMITELIST[i])
      SMITE = true
      if i == 2 or i == 3 then
        ATTACKSMITE = true
      else
        ATTACKSMITE = false
      end
    end
  end
end

function AutoSmite()
  local SmiteDmg = GetSmiteDamage()
  for _, minion in pairs(minionManager(MINION_JUNGLE, 500, myHero, MINION_SORT_MAXHEALTH_DEC).objects) do
    if not minion.dead and minion.visible and ValidTarget(minion, 500) then
      if Menu.Smite[minion.charName:gsub("_", "")] then
        if CanCast(SMITESLOT) and GetRastoyanie(myHero, minion) <= 500 and SmiteDmg >= minion.health then
          CastSpell(SMITESLOT, minion)
        end
      end
    end
  end
end

function DrawSmiteable()
  local SmiteDmg = GetSmiteDamage()
  for _, minion in pairs(minionManager(MINION_JUNGLE, 500, myHero, MINION_SORT_MAXHEALTH_DEC).objects) do
    for j = 1, #SMITEFOCUS do
      if minion.name == SMITEFOCUS[j] then
        if not minion.dead and minion.visible and ValidTarget(minion, 500) then
          if CanCast(SMITESLOT) and GetRastoyanie(myHero, minion) <= 500 and SmiteDmg >= minion.health then
            local posMinion = WorldToScreen(D3DXVECTOR3(minion.x, minion.y, minion.z))
            DrawText("SMITE!", 20, posMinion.x, posMinion.y, ARGB(255,255,0,0))
          end
        end
      end
    end
  end
end

function SmiteKS()
  if not Menu.KS.UseSmiteKS then return end
  for i,enemy in pairs(GetEnemyHeroes()) do
    if not CheckInvul(enemy) and isValid(enemy) then
      if GetRastoyanie(myHero, enemy) <= 500 then
        if SMITE and ATTACKSMITE then
          local SmiteDmg = GetAttackSmiteDamage()
          if SmiteDmg >= enemy.health and CanCast(SMITESLOT) and not enemy.dead then
            CastSmite(enemy)
          end
        end
      end
    end
  end
end


local ATTACKITEMS = {"ItemTiamatCleave", "ItemTitanicHydraCleave", "BilgewaterCutlass", "YoumusBlade", "HextechGunblade", "ItemSwordOfFeastAndFamine"}
local TIAMAT, TITANIC, CUTLASS, YOUMU, GUNBLADE, BOTRK, QSS, DERVISH = false
local TIAMATSLOT, TITANICSLOT, CUTLASSSLOT, YOUMUSLOT, GUNBLADESLOT, BOTRKSLOT, QSSSLOT, DERVISHSLOT, SMITESLOT
local ANTICCITEMS = {"QuicksilverSash", "ItemDervishBlade"}
local CCSPELLS = {"MordekaiserChildrenOfTheGrave", "SkarnerImpale", "LuxLightBindingMis", "Wither", "SonaCrescendo", "DarkBindingMissile", "CurseoftheSadMummy",
"EnchantedCrystalArrow", "BlindingDart", "LuluWTwo", "AhriSeduce", "CassiopeiaPetrifyingGaze", "Terrify", "HowlingGale", "JaxCounterStrike", "KennenShurikenStorm",
"LeblancSoulShackle", "LeonaSolarFlare", "LissandraR", "AlZaharNetherGrasp", "MonkeyKingDecoy", "NamiQ", "OrianaDetonateCommand", "Pantheon_LeapBash", "PuncturingTaunt",
"SejuaniGlacialPrisonStart", "SwainShadowGrasp", "Imbue", "ThreshQ", "UrgotSwap2", "VarusR", "VeigarEventHorizon", "ViR", "InfiniteDuress", "ZyraGraspingRoots",
"paranoiamisschance", "puncturingtauntarmordebuff", "surpression", "zedulttargetmark", "enchantedcrystalarrow", "nasusw"}

function FindItems()
  if (Menu.Item.AttackItem.UseTiamat) then
    GetTiamat()
  end
  if (Menu.Item.AttackItem.UseTitanic) then
    GetTitanic()
  end
  if (Menu.Item.AttackItem.UseBOTRK) then
    GetBOTRK()
  end
  if (Menu.Item.AttackItem.UseCutlass) then
    GetCutlass()
  end
  if (Menu.Item.AttackItem.UseYoumu) then
    GetYoumu()
  end
  if (Menu.Item.AttackItem.UseGunblade) then
    GetGunblade()
  end
  if (Menu.Item.DefItem.UseQSS) then
    GetQSS()
  end
  if (Menu.Item.DefItem.UseDervish) then
    GetDervish()
  end
end

function GetTiamat()
  local slot = GetItem(ATTACKITEMS[1])
  if (slot ~= nil) then
    TIAMAT = true
    TIAMATSLOT = slot
  else
    TIAMAT = false
  end
end

function GetTitanic()
  local slot = GetItem(ATTACKITEMS[2])
  if (slot ~= nil) then
    TITANIC = true
    TITANICSLOT = slot
  else
    TITANIC = false
  end
end

function GetCutlass()
  local slot = GetItem(ATTACKITEMS[3])
  if (slot ~= nil) then
    CUTLASS = true
    CUTLASSSLOT = slot
  else
    CUTLASS = false
  end
end

function GetYoumu()
  local slot = GetItem(ATTACKITEMS[4])
  if (slot ~= nil) then
    YOUMU = true
    YOUMUSLOT = slot
  else
    YOUMU = false
  end
end

function GetGunblade()
  local slot = GetItem(ATTACKITEMS[5])
  if (slot ~= nil) then
    GUNBLADE = true
    GUNBLADESLOT = slot
  else
    GUNBLADE = false
  end
end

function GetBOTRK()
  local slot = GetItem(ATTACKITEMS[6])
  if (slot ~= nil) then
    BOTRK = true
    BOTRKSLOT = slot
  else
    BOTRK = false
  end
end

function GetQSS()
  local slot = GetItem(ANTICCITEMS[1])
  if (slot ~= nil) then
    QSS = true
    QSSSLOT = slot
  else
    QSS = false
  end
end

function GetDervish()
  local slot = GetItem(ANTICCITEMS[2])
  if (slot ~= nil) then
    DERVISH = true
    DERVISHSLOT = slot
  else
    DERVISH = false
  end
end

function CastTiamat()
  if TIAMAT then
    if (CanCast(TIAMATSLOT)) then
      CastSpell(TIAMATSLOT)
    end
  end
end

function CastYoumu()
  if YOUMU then
    if (CanCast(YOUMUSLOT)) then
      CastSpell(YOUMUSLOT)
    end
  end
end

function CastBOTRK(target)
  if BOTRK then
    if (CanCast(BOTRKSLOT)) then
      CastSpell(BOTRKSLOT, target)
    end
  end
end

function CastTITANIC()
  if TITANIC then
    if (CanCast(TITANICSLOT)) then
      CastSpell(TITANICSLOT)
    end
  end
end

function CastCutlass(target)
  if CUTLASS then
    if (CanCast(CUTLASSSLOT)) then
      CastSpell(CUTLASSSLOT, target)
    end
  end
end

function CastGunblade(target)
  if GUNBLADE then
    if (CanCast(GUNBLADESLOT)) then
      CastSpell(GUNBLADESLOT, target)
    end
  end
end

function CastQSS()
  if QSS then
    if CanCast(QSSSLOT) then
      CastSpell(QSSSLOT)
    end
  end
end

function CastDervish()
  if DERVISH then
    if CanCast(DERVISHSLOT) then
      CastSpell(DERVISHSLOT)
    end
  end
end

function GetTiamatDamage(unit)
  local Dmg = myHero:CalcDamage(unit, myHero.totalDamage*0.6)
  return Dmg
end

function GetBOTRKDamage(unit)
  local Dmg = myHero:CalcDamage(unit, unit.maxHealth*0.1)
  return Dmg
end

function GetCutlassDamage(unit)
  local Dmg = myHero:CalcMagicDamage(unit, 100)
  return Dmg
end

function GetGunbladeDamage(unit)
  local Dmg = myHero:CalcMagicDamage(unit, 150+myHero.ap*0.4)
  return Dmg
end

function ItemKS()
  if not Menu.KS.UseItems then return end
  for i,enemy in pairs(GetEnemyHeroes()) do
    if not CheckInvul(enemy) then
      if GetRastoyanie(myHero, enemy) <= 400 then
        if TIAMAT and Menu.KS.UseItems then
          local TiamatDamage = GetTiamatDamage(enemy)
          if TiamatDamage >= enemy.health and CanCast(TIAMATSLOT) and not enemy.dead then
            CastTiamat()
          end
        end
      end
      if GetRastoyanie(myHero, enemy) <= 550 then
        if BOTRK and Menu.KS.UseItems then
          local BOTRKDamage = GetBOTRKDamage(enemy)
          if BOTRKDamage >= enemy.health and CanCast(BOTRKSLOT) and not enemy.dead then
            CastBOTRK(enemy)
          end
        end
        if CUTLASS and Menu.KS.UseItems then
          local CutlassDamage = GetCutlassDamage(enemy)
          if CutlassDamage >= enemy.health and CanCast(CUTLASSSLOT) and not enemy.dead then
            CastCutlass(enemy)
          end
        end
      end
      if GetRastoyanie(myHero, enemy) <= 700 then
        if GUNBLADE and Menu.KS.UseItems then
          local GunbladeDamage = GetGunbladeDamage(enemy)
          if GunbladeDamage >= enemy.health and CanCast(GUNBLADESLOT) and not enemy.dead then
            CastGunblade(enemy)
          end
        end
      end
    end
  end
end


function AutoIgnite()
  if igniteslot == nil then return end
  for i,enemy in pairs(GetEnemyHeroes()) do
    if not enemy.dead and enemy.visible then
      local rastoyanie = math.sqrt((enemy.x-myHero.x)*(enemy.x-myHero.x) + (enemy.z-myHero.z)*(enemy.z-myHero.z))
      if rastoyanie <= 600 then
        if ((50 + (20*myHero.level)) >= enemy.health and igniteslot ~= nil and myHero:CanUseSpell(igniteslot) == READY and
          ValidTarget(enemy, 600)) then 
          CastSpell(igniteslot, enemy)
        end
      end
    end
  end
end


function AutoPotion()
  for i=1, 5 do
    local pot = GetItem(POTS[i])
    if (pot ~= nil) then
      if (((myHero.health*100)/myHero.maxHealth) <= Menu.Auto.autoPotsHealth and not REGEN) then
        CastSpell(pot)
      end
    end
  end
end


function AutoHeal()
  if healslot == nil then return end
  if ((myHero.health*100)/myHero.maxHealth) <= Menu.Auto.autoHealHealth and CanCast(healslot) and ATTACKED then
    CastSpell(healslot)
  end
end

function AutoBarrier()
  if barrierslot == nil then return end
  if ((myHero.health*100)/myHero.maxHealth) <= Menu.Auto.autoBarrierHealth and CanCast(barrierslot) and ATTACKED then
    CastSpell(barrierslot)
  end
end


local AttackResets = {"dariusnoxiantacticsonh", "fioraflurry", "garenq", "hecarimrapidslash", "jaxempowertwo", "jaycehypercharge", "leonashieldofdaybreak", 
"luciane", "lucianq", "lucianw", "monkeykingdoubleattack", "mordekaisermaceofspades", "nasusq", "nautiluspiercinggaze", "netherblade", "parley", 
"poppydevastatingblow", "powerfist", "renektonpreexecute", "rengarq", "shyvanadoubleattack", "sivirw", "takedown", "talonnoxiandiplomacy", "trundletrollsmash", 
"vaynetumble", "vie", "volibearq", "xenzhaocombotarget", "yorickspectral", "reksaiq"}
local NoAttacks = {"jarvanivcataclysmattack", "monkeykingdoubleattack", "shyvanadoubleattack", "shyvanadoubleattackdragon", "zyragraspingplantattack", 
"zyragraspingplantattack2", "zyragraspingplantattackfire", "zyragraspingplantattack2fire", "viktorpowertransfer", "sivirwattackbounce"}
local Attacks = {"caitlynheadshotmissile", "frostarrow", "garenslash2", "kennenmegaproc", "lucianpassiveattack", "masteryidoublestrike", "quinnwenhanced", 
"renektonexecute", "renektonsuperexecute", "rengarnewpassivebuffdash", "trundleq", "xenzhaothrust", "xenzhaothrust2", "xenzhaothrust3", "viktorqbuff"}


function isAutoAttack(name)
  local lName = string.lower(name)
  return (string.find(lName, "attack") and not table.contains(NoAttacks,lName)) or table.contains(Attacks,lName)
end


local PussyOut = 
{
["KatarinaR"] = true,
["AlZaharNetherGrasp"] = true,
["TwistedFateR"] = true,
["VelkozR"] = true,
["InfiniteDuress"] = true,
["JhinR"] = true,
["CaitlynAceintheHole"] = true,
["UrgotSwap2"] = true,
["LucianR"] = true,
["GalioIdolOfDurand"] = true,
["MissFortuneBulletTime"] = true,
["XerathLocusPulse"] = true
}


function GetRastoyanie(a, b)
  local rastoyanie = math.sqrt((b.x-a.x)*(b.x-a.x) + (b.z-a.z)*(b.z-a.z))
  return rastoyanie
end


function CanCast(spell)
  return myHero:CanUseSpell(spell) == READY
end


function FindSlotByName(name)
  if name ~= nil then
    for i=0, 12 do
      if string.lower(myHero:GetSpellData(i).name) == string.lower(name) then
        return i
      end
    end
  end  
  return nil
end

function GetItem(name)
  local slot = FindSlotByName(name)
  return slot 
end


function OnWndMsg(msg, key)
  if msg == WM_LBUTTONDOWN and Menu.Combo.focus and not myHero.dead then
    for i, pussy in ipairs(GetEnemyHeroes()) do
      if GetRastoyanie(mousePos, pussy) <= 120 and isValid(pussy) and not CheckInvul(pussy) then
        if FOCUSED ~= pussy then
          FOCUSED = pussy
          print("<font color = \"#B13070\">[HENTAI BUNDLE]</font> focus "..pussy.charName)
        else
          FOCUSED = nil
          print("<font color = \"#B13070\">[HENTAI BUNDLE]</font> stop focus "..pussy.charName)
        end
      end
    end
  end
end

local invul = {"undyingrage", "sionpassivezombie", "aatroxpassivedeath", "chronoshift", "judicatorintervention"}

function CheckInvul(unit)
  for i,buff in pairs(invul) do
    if TargetHaveBuff(buff, unit) then
      return true
    end
  end
    return false
end

function DrawSelectedTarget()
  if not Menu.Combo.focus then return end
  local target = FOCUSED
  if target == nil then return end
  if (target ~= nil and target.type == myHero.type and target.team ~= myHero.team) then
    DrawFPSCircle(target.x, target.z, 150, ARGB(255,255,0,0), 4)
    local posMinion = WorldToScreen(D3DXVECTOR3(target.x, target.y, target.z))
    DrawText("FOCUS!", 20, posMinion.x, posMinion.y, ARGB(255,255,255,255))
  end
end

function GetHentaiTarget(range)
  local selectedTarget = FOCUSED
  if selectedTarget ~= nil and Menu.Combo.focus then
    if selectedTarget.type == myHero.type and selectedTarget.team ~= myHero.team and isValid(selectedTarget, range + 100) and not CheckInvul(enemy) then
      return selectedTarget
    end
  end
  local hentaiTarget = nil
  local lessCast = 0
  for i = 1, #GetEnemyHeroes() do
    local enemy = GetEnemyHeroes()[i]
    if isValid(enemy, range) and not CheckInvul(enemy) then
      local kArmor = (100+enemy.armor)/100
      local kKillable = kArmor*enemy.health
      if kKillable <= lessCast or lessCast == 0 then
        hentaiTarget = enemy
        lessCast = kKillable
      end
    end
  end
  return hentaiTarget
end

function GetHentaiTargetMagic(range)
  local selectedTarget = FOCUSED
  if selectedTarget ~= nil and Menu.Combo.focus then
    if selectedTarget.type == myHero.type and selectedTarget.team ~= myHero.team and isValid(selectedTarget, range + 100) and not CheckInvul(enemy) then
      return selectedTarget
    end
  end
  local hentaiTarget = nil
  local lessCast = 0
  for i = 1, #GetEnemyHeroes() do
    local enemy = GetEnemyHeroes()[i]
    if isValid(enemy, range) and not CheckInvul(enemy) then
      local kArmor = (100+enemy.magicArmor)/100
      local kKillable = kArmor*enemy.health
      if kKillable <= lessCast or lessCast == 0 then
        hentaiTarget = enemy
        lessCast = kKillable
      end
    end
  end
  return hentaiTarget
end

function isValid(object, range)
  return object ~= nil and object.valid and object.visible and not object.dead and object.bInvulnerable == 0
   and object.bTargetable and (range == nil or GetRastoyanie(object, myHero) <= range)
end


function DrawLineA(x1, y1, x2, y2, color)
  DrawLine(x1, y1, x2, y2, 1, color)
end

function DrawFPSCircle(xCoordinate, zCoordinate, radius, color, quality)
  for i=-radius*math.cos(math.pi/4), radius*math.cos(math.pi/4)-1, radius*math.cos(math.pi/4)/quality do
    local nigger = WorldToScreen(D3DXVECTOR3((xCoordinate+i), myHero.y, (zCoordinate + math.sqrt(radius*radius-i*i))))
    local stalin = WorldToScreen(D3DXVECTOR3((xCoordinate+i), myHero.y, (zCoordinate - math.sqrt(radius*radius-i*i))))
    local hentai = WorldToScreen(D3DXVECTOR3((xCoordinate+i+radius*math.cos(math.pi/4)/quality), myHero.y, 
      (zCoordinate + math.sqrt(radius*radius-(i+radius*math.cos(math.pi/4)/quality)*(i+radius*math.cos(math.pi/4)/quality)))))
    local ebola = WorldToScreen(D3DXVECTOR3((xCoordinate+i+radius*math.cos(math.pi/4)/quality), myHero.y, 
      (zCoordinate - math.sqrt(radius*radius-(i+radius*math.cos(math.pi/4)/quality)*(i+radius*math.cos(math.pi/4)/quality)))))

    if (nigger.x>0 and nigger.x<WINDOW_W) and (nigger.y>0 and nigger.y<WINDOW_H) and (hentai.x>0 and hentai.x<WINDOW_W) and (hentai.y>0 and hentai.y<WINDOW_H) then
      DrawLineA(nigger.x,nigger.y,hentai.x,hentai.y, color)
    end
    if (stalin.x>0 and stalin.x<WINDOW_W) and (stalin.y>0 and stalin.y<WINDOW_H) and (ebola.x>0 and ebola.x<WINDOW_W) and (ebola.y>0 and ebola.y<WINDOW_H) then
      DrawLineA(stalin.x,stalin.y,ebola.x,ebola.y, color)
    end
  end

  for i=-radius*math.cos(math.pi/4), radius*math.cos(math.pi/4)-1, radius*math.cos(math.pi/4)/quality do
    local nigger = WorldToScreen(D3DXVECTOR3((xCoordinate+math.sqrt(radius*radius-i*i)), myHero.y, (zCoordinate + i)))
    local stalin = WorldToScreen(D3DXVECTOR3((xCoordinate-math.sqrt(radius*radius-i*i)), myHero.y, (zCoordinate +i)))
    local hentai = WorldToScreen(D3DXVECTOR3((xCoordinate+math.sqrt(radius*radius-(i+radius*math.cos(math.pi/4)/quality)*(i+radius*math.cos(math.pi/4)/quality))), 
      myHero.y, (zCoordinate + i+radius*math.cos(math.pi/4)/quality)))
    local ebola = WorldToScreen(D3DXVECTOR3((xCoordinate-math.sqrt(radius*radius-(i+radius*math.cos(math.pi/4)/quality)*(i+radius*math.cos(math.pi/4)/quality))), 
      myHero.y, (zCoordinate + i+radius*math.cos(math.pi/4)/quality)))

    if (nigger.x>0 and nigger.x<WINDOW_W) and (nigger.y>0 and nigger.y<WINDOW_H) and (hentai.x>0 and hentai.x<WINDOW_W) and (hentai.y>0 and hentai.y<WINDOW_H) then
      DrawLineA(nigger.x,nigger.y,hentai.x,hentai.y, color)
    end
    if (stalin.x>0 and stalin.x<WINDOW_W) and (stalin.y>0 and stalin.y<WINDOW_H) and (ebola.x>0 and ebola.x<WINDOW_W) and (ebola.y>0 and ebola.y<WINDOW_H) then
      DrawLineA(stalin.x,stalin.y,ebola.x,ebola.y, color)
    end
  end
end

function GetHPBarPos(enemy)
  enemy.barData = {PercentageOffset = {x = -0.05, y = 0}}
  local barPos = GetUnitHPBarPos(enemy)
  local barPosOffset = GetUnitHPBarOffset(enemy)
  local barOffset = { x = enemy.barData.PercentageOffset.x, y = enemy.barData.PercentageOffset.y }
  local barPosPercentageOffset = { x = enemy.barData.PercentageOffset.x, y = enemy.barData.PercentageOffset.y }
  local BarPosOffsetX = -50
  local BarPosOffsetY = 46
  local CorrectionY = 39
  local StartHpPos = 31 
  barPos.x = math.floor(barPos.x + (barPosOffset.x - 0.5 + barPosPercentageOffset.x) * BarPosOffsetX + StartHpPos)
  barPos.y = math.floor(barPos.y + (barPosOffset.y - 0.5 + barPosPercentageOffset.y) * BarPosOffsetY + CorrectionY)
  local StartPos = Vector(barPos.x , barPos.y, 0)
  local EndPos = Vector(barPos.x + 108 , barPos.y , 0)    
  return Vector(StartPos.x, StartPos.y, 0), Vector(EndPos.x, EndPos.y, 0)
end

function DrawLineHPBar(damage, text, unit, enemyteam)
  if unit.dead or not unit.visible then return end
  local p = WorldToScreen(D3DXVECTOR3(unit.x, unit.y, unit.z))
  if not OnScreen(p.x, p.y) then return end
  local thedmg = 0
  local line = 2
  local linePosA  = {x = 0, y = 0 }
  local linePosB  = {x = 0, y = 0 }
  local TextPos   = {x = 0, y = 0 }

  if damage >= unit.health then
    thedmg = unit.health - 1
    text = "KILLABLE!"
  else
    thedmg = damage
    text = "Possible Damage"
  end

  thedmg = math.round(thedmg)

  local StartPos, EndPos = GetHPBarPos(unit)
  local Real_X = StartPos.x + 24
  local Offs_X = (Real_X + ((unit.health - thedmg) / unit.maxHealth) * (EndPos.x - StartPos.x - 2))
  if Offs_X < Real_X then Offs_X = Real_X end 
  local mytrans = 350 - math.round(255*((unit.health-thedmg)/unit.maxHealth))
  if mytrans >= 255 then mytrans=254 end
  local my_bluepart = math.round(400*((unit.health-thedmg)/unit.maxHealth))
  if my_bluepart >= 255 then my_bluepart=254 end

  if enemyteam then
    linePosA.x = Offs_X-150
    linePosA.y = (StartPos.y-(30+(line*15)))    
    linePosB.x = Offs_X-150
    linePosB.y = (StartPos.y-10)
    TextPos.x = Offs_X-148
    TextPos.y = (StartPos.y-(30+(line*15)))
  else
    linePosA.x = Offs_X-125
    linePosA.y = (StartPos.y-(30+(line*15)))    
    linePosB.x = Offs_X-125
    linePosB.y = (StartPos.y-15)

    TextPos.x = Offs_X-122
    TextPos.y = (StartPos.y-(30+(line*15)))
  end

  DrawLine(linePosA.x, linePosA.y, linePosB.x, linePosB.y , 2, ARGB(mytrans, 255, my_bluepart, 0))
  DrawText(tostring(thedmg).." "..tostring(text), 15, TextPos.x, TextPos.y , ARGB(mytrans, 255, my_bluepart, 0))
end


function Five_Buff_Add(unit, target, buff)
  for i=1, 5 do
    if (buff.name == POTS[i] and unit.isMe) then
      REGEN = true
    end
  end
  for j = 1, #CCSPELLS do
    if target then
      if target.isMe and buff.name == CCSPELLS[j] then
        UNDERCC = true
      end
    end
  end
end

function Five_Buff_Rem(unit, buff)
  for i=1, 5 do
    if (buff.name == POTS[i] and unit.isMe) then
      REGEN = false
    end
  end
  for j = 1, #CCSPELLS do
    if unit.isMe and buff.name == CCSPELLS[j] then
      UNDERCC = false
    end
  end
end


function OnProcessSpell(unit, spell)
  local topkek = false
  if spell ~= nil and spell.target ~= nil and unit ~= nil then
    if spell.target.isMe and unit.team ~= myHero.team then
      ATTACKED = true
      DelayAction(function() ATTACKED = false end, 1)
    end
  end
end

function OnProcessAttack(unit, spell)
  if unit ~= nil and spell ~= nil then
    if GetRastoyanie(myHero, unit) <= 1000 then
      if spell.target == myHero then
        ATTACKED = true
        DelayAction(function() ATTACKED = false end, 1)
      end
    end
  end
end


function GetBestLineFarmPosition(range, width, objects)
  local BestPos 
  local BestHit = 0
  for i, object in ipairs(objects) do
    local EndPos = Vector(myHero.pos) + range * (Vector(object) - Vector(myHero.pos)):normalized()
    local hit = CountObjectsOnLineSegment(myHero.pos, EndPos, width, objects)
    if hit > BestHit then
      BestHit = hit
      BestPos = Vector(object)
      if BestHit == #objects then
        break
      end
    end
  end
  return BestPos, BestHit
end

function CountObjectsOnLineSegment(StartPos, EndPos, width, objects)
  local n = 0
  for i, object in ipairs(objects) do
    local pointSegment, pointLine, isOnSegment = VectorPointProjectionOnLineSegment(StartPos, EndPos, object)
    if isOnSegment and GetDistanceSqr(pointSegment, object) < width * width then
      n = n + 1
    end
  end
  return n
end


function GetBestCircularFarmPosition(range, radius, objects)
  local BestPos 
  local BestHit = 0
  for i, object in ipairs(objects) do
    local hit = CountObjectsNearPos(object.pos or object, range, radius, objects)
    if hit > BestHit then
      BestHit = hit
      BestPos = Vector(object)
      if BestHit == #objects then
        break
      end
    end
  end
  return BestPos, BestHit
end

function CountObjectsNearPos(pos, range, radius, objects)
  local n = 0
  for i, object in ipairs(objects) do
    if GetDistanceSqr(pos, object) <= radius * radius then
      n = n + 1
    end
  end
  return n
end


function OnLoad()
  AddApplyBuffCallback(Five_Buff_Add)
  AddRemoveBuffCallback(Five_Buff_Rem)

  
  igniteslot = FindSlotByName("summonerdot")
  healslot = FindSlotByName("summonerheal")
  barrierslot = FindSlotByName("summonerbarrier")

  
  Menu = scriptConfig("[Hentai Five]", "HentaiFive")

  Menu:addSubMenu("[Key Binds]", "Key")

  Menu:addSubMenu("[Combo]", "Combo")
  Menu.Combo:addParam("focus", "Focus selected target", SCRIPT_PARAM_ONOFF, true)

  Menu:addSubMenu("[Harras]", "Harras")

  Menu:addSubMenu("[Farm]", "Farm")

  Menu:addSubMenu("[Prediction]", "Prediction")

  Menu:addSubMenu("[Killsteal]", "KS")
  Menu.KS:addParam("UseSmiteKS", "Use Smite in Killsteal", SCRIPT_PARAM_ONOFF, true)
  if igniteslot ~= nil then
    Menu.KS:addParam("ksIgnite", "Use Ignite for killsteal", SCRIPT_PARAM_ONOFF, true)
  end
  Menu.KS:addParam("UseItems", "Use Items in Killsteal", SCRIPT_PARAM_ONOFF, true)

  Menu:addSubMenu("[Smite Usage]", "Smite")
  Menu.Smite:addParam("UseSmite", "Enable Smite usage", SCRIPT_PARAM_ONKEYTOGGLE, true, string.byte("N"))
  Menu.Smite:addParam("UseSmiteCombo", "Use Smite in combo", SCRIPT_PARAM_ONKEYTOGGLE, true, string.byte("M"))
  Menu.Smite:addParam("SRUBaron", "Smite Baron", SCRIPT_PARAM_ONOFF, true)
  Menu.Smite:addParam("SRUDragon", "Smite Dragon", SCRIPT_PARAM_ONOFF, true)
  Menu.Smite:addParam("SRURed", "Smite Red Buff", SCRIPT_PARAM_ONOFF, true)
  Menu.Smite:addParam("SRUBlue", "Smite Blue Buff", SCRIPT_PARAM_ONOFF, true)
  Menu.Smite:addParam("SRURazorbeak", "Smite Wraith", SCRIPT_PARAM_ONOFF, false)
  Menu.Smite:addParam("SRUMurkwolf", "Smite Wolf", SCRIPT_PARAM_ONOFF, false)
  Menu.Smite:addParam("SRUKrug", "Smite Golem", SCRIPT_PARAM_ONOFF, false)
  Menu.Smite:addParam("SRUGromp", "Smite Gromp", SCRIPT_PARAM_ONOFF, false)

  Menu:addSubMenu("[Item Usage]", "Item")
  Menu.Item:addParam("UseItem", "Enable Item Usage", SCRIPT_PARAM_ONOFF, true)
  Menu.Item:addSubMenu("[Offensive Items]", "AttackItem")
  Menu.Item.AttackItem:addParam("UseTiamat", "Use Tiamat/Hydra", SCRIPT_PARAM_ONOFF, true)
  Menu.Item.AttackItem:addParam("UseTitanic", "Use Titanic Hydra", SCRIPT_PARAM_ONOFF, true)
  Menu.Item.AttackItem:addParam("UseCutlass", "Use Bilgewater Cutlass", SCRIPT_PARAM_ONOFF, true)
  Menu.Item.AttackItem:addParam("UseBOTRK", "Use BOTRK", SCRIPT_PARAM_ONOFF, true)
  Menu.Item.AttackItem:addParam("UseYoumu", "Use Youmus Blade", SCRIPT_PARAM_ONOFF, true)
  Menu.Item.AttackItem:addParam("UseGunblade", "Use Hextech Gunblade", SCRIPT_PARAM_ONOFF, true)
  Menu.Item:addSubMenu("[Anti CC]", "DefItem")
  Menu.Item.DefItem:addParam("EnableACC", "Enable AntiCC", SCRIPT_PARAM_ONOFF, true)
  Menu.Item.DefItem:addParam("UseQSS", "Use Quicksilver Sash", SCRIPT_PARAM_ONOFF, true)
  Menu.Item.DefItem:addParam("UseDervish", "Use Dervish Blade", SCRIPT_PARAM_ONOFF, true)

  Menu:addSubMenu("[Draws]", "Draws")
  Menu.Draws:addParam("drawTarget", "Draw Selected Target", SCRIPT_PARAM_ONOFF, true)
  Menu.Draws:addParam("DrawSmite", "Draw Smite range", SCRIPT_PARAM_ONOFF, true)
  Menu.Draws:addParam("DrawSmiteable", "Draw if jungle mob is Smiteable ", SCRIPT_PARAM_ONOFF, true)
  Menu.Draws:addParam("DrawSmiteStatus", "Draw Smite Status on window", SCRIPT_PARAM_ONOFF, true)

  Menu:addSubMenu("[Auto]", "Auto")
  Menu.Auto:addParam("autoPots", "Auto Potions usage", SCRIPT_PARAM_ONOFF, true)
  Menu.Auto:addParam("autoPotsHealth", "% Health for autopots", SCRIPT_PARAM_SLICE, 75, 0, 100, 0)
  if healslot ~= nil then
    Menu.Auto:addParam("autoHeal", "Auto Heal usage", SCRIPT_PARAM_ONOFF, true)
    Menu.Auto:addParam("autoHealHealth", "% Health for Heal usage", SCRIPT_PARAM_SLICE, 10, 0, 100, 0)
  end
  if barrierslot ~= nil then
    Menu.Auto:addParam("autoBarrier", "Auto Barrier usage", SCRIPT_PARAM_ONOFF, true)
    Menu.Auto:addParam("autoBarrierHealth", "% Health for Barrier usage", SCRIPT_PARAM_SLICE, 10, 0, 100, 0)
  end

  Menu:addParam("info1", "", SCRIPT_PARAM_INFO, "")
  Menu:addParam("info2", ""..scriptname.." [ver. "..version.."]", SCRIPT_PARAM_INFO, "")
  Menu:addParam("info3", "Created by "..developer.."", SCRIPT_PARAM_INFO, "")
  Menu:addParam("info4", "Contact me: "..contact.."", SCRIPT_PARAM_INFO, "")

  if _G.Reborn_Loaded ~= nil then
    SAC = true
    PrintChat("<font color = \"#B13070\">HENTAI BUNDLE</font> <font color = \"#4DFF4D\">SAC FOUND</font>")
  end
  
  if _G.MMA_IsLoaded then
    MMA = true
    PrintChat("<font color = \"#B13070\">HENTAI BUNDLE</font> <font color = \"#4DFF4D\">MMA FOUND</font>")
  end
  if _G.NebelwolfisOrbWalkerInit then
    WOLFY = true
    PrintChat("<font color = \"#B13070\">HENTAI BUNDLE</font> <font color = \"#4DFF4D\">NEBELWOLFI FOUND</font>")
  end
  if _Pewalk then
    PEW = true
    PrintChat("<font color = \"#B13070\">HENTAI BUNDLE</font> <font color = \"#4DFF4D\">PEWALK FOUND</font>")
  end
  if _G.SxOrb ~= nil then
    SXORB = true
    PrintChat("<font color = \"#B13070\">HENTAI BUNDLE</font> <font color = \"#4DFF4D\">SXORB FOUND</font>")
  end

  if myHero.charName == "Renekton" then
    AddLoadCallback(Renekton_Load)
    AddTickCallback(Renekton_Tick)
    AddDrawCallback(Renekton_Draw)
  end

  if myHero.charName == "JarvanIV" then
    AddLoadCallback(Jarvan_Load)
    AddTickCallback(Jarvan_Tick)
    AddDrawCallback(Jarvan_Draw)
    AddCreateObjCallback(Jarvan_OnCreateObj)
    AddDeleteObjCallback(Jarvan_OnDeleteObj)
    AddProcessSpellCallback(Jarvan_OnProcessSpell)
  end

  if myHero.charName == "Talon" then
    AddLoadCallback(Talon_Load)
    AddTickCallback(Talon_Tick)
    AddDrawCallback(Talon_Draw)
    AddProcessSpellCallback(Talon_OnProcessSpell)
  end

  
  PrintChat("<font color = \"#B13070\">[HENTAI BUNDLE]</font> <font color = \"#4DFF4D\">LOADED</font>")
end

function OnTick()
  
  GetSmiteSlot()
  if SMITE then
    SmiteKS()
    if Menu.Smite.UseSmite then
      AutoSmite()
    end
  end
  
  if Menu.Item.UseItem then
    FindItems()
  end
  
  CheckFountain()
  if (Menu.Auto.autoPots and not REGEN) and not FONTAN then
    AutoPotion()
  end
  
  if Menu.Auto.autoHeal then
    AutoHeal()
  end
  if Menu.Auto.autoBarrier then
    AutoBarrier()
  end
  
  if UNDERCC and Menu.Item.UseItem and Menu.Item.DefItem.EnableACC then
    if Menu.Item.DefItem.UseQSS and QSS then
      CastQSS()
    end
    if Menu.Item.DefItem.UseDervish and DERVISH then
      CastDervish()
    end
  end
  
  ItemKS()
  
  if igniteslot ~= nil and Menu.KS.ksIgnite then
    AutoIgnite()
  end
end

function OnDraw()
  if not myHero.dead then
    if SMITE then
      if Menu.Smite.UseSmite then
        if Menu.Draws.DrawSmiteStatus then
          if Menu.Smite.UseSmite then
            DrawText ("USE SMITE [N]", 20, 150, 120, 0xFF00FF00)
          end
          if Menu.Smite.UseSmiteCombo then
            DrawText ("USE SMITE in SBTW [M]", 20, 150, 100, 0xFF00FF00)
          else
            DrawText ("DON'T USE SMITE in SBTW [M]", 20, 150, 100, 0xFFFF0000)
          end
        end
        if Menu.Draws.DrawSmite then
          DrawFPSCircle(myHero.x, myHero.z, 500, ARGB(230,255,55,00), 3)
        end
        if Menu.Draws.DrawSmiteable then
          DrawSmiteable()
        end
      else
        DrawText ("DON'T USE SMITE [N]", 20, 150, 120, 0xFFFF0000)
      end
    end
    if Menu.Draws.drawTarget then
      DrawSelectedTarget()
    end
  end
end

function OrbsOff()
  if SAC then
    _G.AutoCarry.MyHero:MovementEnabled(false)
    _G.AutoCarry.MyHero:AttacksEnabled(false)
    DelayAction(function()
      _G.AutoCarry.MyHero:MovementEnabled(true)
      _G.AutoCarry.MyHero:AttacksEnabled(true)
    end, 0.1)
  end
  if MMA then
    _G.MMA_AvoidMovement(false)
    _G.MMA_StopAttacks(false)
    DelayAction(function()
      _G.MMA_AvoidMovement()
      _G.MMA_StopAttacks()
    end, 0.1)
  end
  if WOLFY then
    _G.NebelwolfisOrbWalker:SetOrb(false)
    DelayAction(function()
      _G.NebelwolfisOrbWalker:SetOrb(true)
    end, 0.1)
  end
  if PEW then
    _Pewalk.AllowAttack(false)
    _Pewalk.AllowMove(false)
    DelayAction(function()
      _Pewalk.AllowAttack(true)
      _Pewalk.AllowMove(true)
    end, 0.1)
  end
  if SXORB then
    SxOrb:DisableAttacks()
    SxOrb:DisableMove()
    DelayAction(function()
      SxOrb:EnableMove()
      SxOrb:EnableAttacks()
    end, 0.1)
  end
end

function OrbsReset(unit)
  if SAC then
    _G.AutoCarry.Orbwalker:ResetAttackTimer()
  end
end


function Renekton_Load()
  WOMBOCOMBO = false

  AddProcessAttackCallback(Renekton_ProcessAttack)

  RENEKTON_VARS = {
    AA = {RANGE = 125},
    Q = {RADIUS = 310},
    W = {RANGE = 185},
    E = {RANGE = 425, WIDTH = 100}
  }

  Menu.Key:addParam("combo", "Combo", SCRIPT_PARAM_ONKEYDOWN, false, string.byte(" "))
  Menu.Key:addParam("harras", "Harras", SCRIPT_PARAM_ONKEYDOWN, false, string.byte("C"))
  Menu.Key:addParam("lasthit", "Lasthit", SCRIPT_PARAM_ONKEYDOWN, false, string.byte("X"))
  Menu.Key:addParam("laneclear", "Laneclear/Jungleclear", SCRIPT_PARAM_ONKEYDOWN, false, string.byte("V"))

  Menu.Combo:addParam("comboMode", "Burst combo", SCRIPT_PARAM_ONKEYTOGGLE, false, string.byte("T"))
  Menu.Combo:addParam("useGC", "Use E to gapclose", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("useQ", "Use Q", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("useW", "Use W", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("useWpref", "Prefer empowered W", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("useE", "Use E", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("useEclose", "Use 2ndE even if enemy too close", SCRIPT_PARAM_ONOFF, true)

  Menu.Harras:addParam("useHR", "Hit n Run harras", SCRIPT_PARAM_ONOFF, true)
  Menu.Harras:addParam("useGC", "Use 2E to gapclose (doesnt work in hit n run)", SCRIPT_PARAM_ONOFF, true)
  Menu.Harras:addParam("useQ", "Use Q", SCRIPT_PARAM_ONOFF, true)
  Menu.Harras:addParam("useW", "Use W", SCRIPT_PARAM_ONOFF, true)
  Menu.Harras:addParam("useE", "Use E", SCRIPT_PARAM_ONOFF, true)

  Menu.Farm:addSubMenu("[Lasthit]", "Lasthit")
  Menu.Farm.Lasthit:addParam("lasthitQ", "Use Q for lasthit", SCRIPT_PARAM_ONOFF, false)
  Menu.Farm:addSubMenu("[Clear]", "Laneclear")
  Menu.Farm.Laneclear:addParam("laneclearQ", "Use Q for clear", SCRIPT_PARAM_ONOFF, true)
  Menu.Farm.Laneclear:addParam("laneclearW", "Use W for clear", SCRIPT_PARAM_ONOFF, true)
  Menu.Farm.Laneclear:addParam("laneclearE", "Use E for clear", SCRIPT_PARAM_ONOFF, true)

  Menu.Draws:addParam("drawHP", "Draw damage on HP Bar", SCRIPT_PARAM_ONOFF, true)
  Menu.Draws:addParam("drawQ", "Draw Q range", SCRIPT_PARAM_ONOFF, false)
  Menu.Draws:addParam("drawE", "Draw E range", SCRIPT_PARAM_ONOFF, true)

  Menu.Prediction:addParam("info1", "No pred for croco Q_Q", SCRIPT_PARAM_INFO, "")

  Menu.KS:addParam("ksQ", "Use Q for killsteal", SCRIPT_PARAM_ONOFF, true)
  Menu.KS:addParam("ksW", "Use W for killsteal", SCRIPT_PARAM_ONOFF, true)
  Menu.KS:addParam("ksE", "Use E for killsteal", SCRIPT_PARAM_ONOFF, true)

  Menu.Auto:addParam("autoR", "Auto R usage", SCRIPT_PARAM_ONOFF, true)
  Menu.Auto:addParam("autoRHealth", "% Health for R", SCRIPT_PARAM_SLICE, 50, 0, 100, 0)

end

function Renekton_Tick()
  
  if Menu.Key.combo then
    Renekton_Combo()
  end
  
  if Menu.Key.harras then
    Renekton_Harras()
  end
  
  if Menu.Key.lasthit then
    Renekton_Lasthit()
  end
  
  if Menu.Key.laneclear then
    Renekton_Clear()
  end
  
  Renekton_Killsteal()
  
  Renekton_AutoR()
end

function Renekton_Draw()
  if Menu.Draws.drawHP then
    Renekton_DrawHP()
  end
  if Menu.Draws.drawQ then
    DrawFPSCircle(myHero.x, myHero.z, RENEKTON_VARS.Q.RADIUS, ARGB(255,255,255,255), 3)
  end
  if Menu.Draws.drawE then
    DrawFPSCircle(myHero.x, myHero.z, RENEKTON_VARS.E.RANGE, ARGB(255,255,255,255), 3)
  end
end

function Renekton_Combo()
  local flag = true
  if Menu.Combo.comboMode then
    local target = GetHentaiTarget(RENEKTON_VARS.E.RANGE*2)
    if target ~= nil then
      local rastoyanie = GetRastoyanie(myHero, target)
      if rastoyanie > 300 and Menu.Combo.useGC then
        Renekton_Gapclose(target)
      end
      if (CanCast(_W) or TargetHaveBuff("RenektonPreExecute", myHero)) and rastoyanie <= 200 and Menu.Combo.useW then
        Renekton_CastW()
        OrbsOff()
        myHero:Attack(target)
        flag = true
      else
        flag = false
      end
      if rastoyanie < RENEKTON_VARS.Q.RADIUS and (not flag or not TargetHaveBuff("RenektonPreExecute", myHero)) then
        if Menu.Combo.useWpref and myHero.mana >= 50 and CanCast(_W) then
          do return end
        end
        Renekton_CastQ()
      end
      if Menu.Combo.useEclose and rastoyanie < RENEKTON_VARS.E.RANGE and myHero.mana < 50 then
        CastSpell(_E, target.x, target.z)
      end
    end
  else
    local target = GetHentaiTarget(RENEKTON_VARS.E.RANGE*2)
    if target ~= nil then
      local rastoyanie = GetRastoyanie(myHero, target)
      if rastoyanie > 200 and Menu.Combo.useGC then
        Renekton_Gapclose(target)
      end
      if Menu.Combo.useEclose and rastoyanie < RENEKTON_VARS.E.RANGE and myHero.mana < 50 then
        CastSpell(_E, target.x, target.z)
      end
      if (CanCast(_W) or TargetHaveBuff("RenektonPreExecute", myHero)) and rastoyanie <= 200 and Menu.Combo.useW then
        OrbsOff()
        myHero:Attack(target)
        flag = true
      else
        flag = false
      end
      if rastoyanie < RENEKTON_VARS.Q.RADIUS and (not flag or not TargetHaveBuff("RenektonPreExecute", myHero)) then
        if Menu.Combo.useWpref and myHero.mana >= 50 and CanCast(_W) then
          do return end
        end
        Renekton_CastQ()
      end
    end
  end
  if Menu.Item.UseItem then
    local target = GetHentaiTarget(500)
    if target ~= nil then
      if GetRastoyanie(myHero, target) <= 200 then
        CastYoumu()
      end
      if Menu.Smite.UseSmiteCombo then
        if SMITE and ATTACKSMITE then
          CastSmite(target)
        end
      end
      CastBOTRK(target)
      CastGunblade(target)
      CastCutlass(target)
    end
  end
end

flagA = false
flagB = false

function Renekton_Harras()
  if Menu.Harras.useHR then
    local target = GetHentaiTarget(RENEKTON_VARS.E.RANGE)
    if target ~= nil then
      local rastoyanie = GetRastoyanie(myHero, target)
      if not flagA and CanCast(_E) and myHero:GetSpellData(_E).name ~= "RenektonDice" then
        runPos = Vector(myHero.x, myHero.y, myHero.z)
        flagA = true
      end
      if CanCast(_E) and myHero:GetSpellData(_E).name ~= "RenektonDice" then
        CastSpell(_E, target.x, target.z)
      end
      if (CanCast(_W) or TargetHaveBuff("RenektonPreExecute", myHero)) and rastoyanie <= 200 and Menu.Harras.useW then
        OrbsOff()
        myHero:Attack(target)
        flag = true
      else
        flag = false
      end
      if rastoyanie < RENEKTON_VARS.Q.RADIUS and (not flag or not TargetHaveBuff("RenektonPreExecute", myHero)) then
        Renekton_CastQ()
      end
      if myHero:GetSpellData(_E).name == "RenektonDice" and not CanCast(_Q) and flagB then
        local rastoyanieA = GetRastoyanie(myHero, runPos)
        local a = (runPos.x - myHero.x)/rastoyanieA * RENEKTON_VARS.E.RANGE + myHero.x
        local b = (runPos.z - myHero.z)/rastoyanieA * RENEKTON_VARS.E.RANGE + myHero.z
        CastSpell(_E, a, b)
        DelayAction(function() flagA = false end, 2)
      end
    end
  else
    local target = GetHentaiTarget(RENEKTON_VARS.E.RANGE*2)
    if target ~= nil then
      local rastoyanie = GetRastoyanie(myHero, target)
      if rastoyanie > 200 and Menu.Harras.useGC then
        Renekton_Gapclose(target)
      end
      if Menu.Harras.useEclose and rastoyanie < RENEKTON_VARS.E.RANGE and myHero.mana < 50 then
        CastSpell(_E, target.x, target.z)
      end
      if (CanCast(_W) or TargetHaveBuff("RenektonPreExecute", myHero)) and rastoyanie <= 200 and Menu.Harras.useW then
        OrbsOff()
        myHero:Attack(target)
        flag = true
      else
        flag = false
      end
      if rastoyanie < RENEKTON_VARS.Q.RADIUS and (not flag or not TargetHaveBuff("RenektonPreExecute", myHero)) then
        if Menu.Harras.useWpref and myHero.mana >= 50 and CanCast(_W) then
          do return end
        end
        Renekton_CastQ()
      end
    end
  end
end

function Renekton_Killsteal()
  for i,enemy in pairs(GetEnemyHeroes()) do
    if not CheckInvul(enemy) and isValid(enemy) then
      local QDmg = Renekton_GetQDamage(enemy)
      local EDmg = Renekton_GetEDamage(enemy)
      if QDmg >= enemy.health and GetRastoyanie(myHero, enemy) <= RENEKTON_VARS.Q.RADIUS then
        Renekton_CastQ()
      end
      if EDmg >= enemy.health and GetRastoyanie(myHero, enemy) <= RENEKTON_VARS.E.RANGE then
        CastSpell(_E, enemy.x, enemy.z)
      end
    end
  end
end

function Renekton_Wcheck()
  return CanCast(_W) or TargetHaveBuff("RenektonPreExecute", myHero)
end

function Renekton_ProcessAttack(unit,spell)
  if unit and unit.isMe and spell then
    if string.lower(spell.name) == "renektonexecute" or string.lower(spell.name) == "renektonsuperexecute" then
      flagB = true
      DelayAction(function() flagB = false end, 2)
    end
  end
  if unit and unit.isMe and spell and TIAMAT then
    if string.lower(spell.name) == "renektonexecute" or string.lower(spell.name) == "renektonsuperexecute" then
      CastTiamat()
    end
  end
  if unit and unit.isMe and spell and TITANIC then
    if string.lower(spell.name) == "renektonexecute" or string.lower(spell.name) == "renektonsuperexecute" then
      CastTITANIC()
      OrbsOff()
      myHero:Attack(spell.target)
    end
  end
  if not unit.isMe then return end
  if isAutoAttack(spell.name) and spell.target and spell.target.type ~= myHero.type and Menu.Key.laneclear then
    local AADmg = myHero:CalcDamage(spell.target, myHero.totalDamage)
    if not spell.target.dead and not (AADmg >= spell.target.health) and Menu.Farm.Laneclear.laneclearW then
      Renekton_CastW()
      OrbsReset(spell.target)
    end
  end
  if isAutoAttack(spell.name) and spell.target and spell.target.type == myHero.type and Menu.Key.combo then
    local AADmg = myHero:CalcDamage(spell.target, myHero.totalDamage)
    if not spell.target.dead then
      Renekton_CastW()
      OrbsReset(spell.target)
    end
  end
  if isAutoAttack(spell.name) and spell.target and spell.target.type == myHero.type and Menu.Key.harras then
    local AADmg = myHero:CalcDamage(spell.target, myHero.totalDamage)
    if not spell.target.dead then
      Renekton_CastW()
      OrbsReset(spell.target)
    end
  end
end

function Renekton_Gapclose(unit)
  if not CanCast(_E) then return end
  local rastoyanie = GetRastoyanie(myHero, unit)
  if rastoyanie < RENEKTON_VARS.E.RANGE then
    if rastoyanie > 250 then
      local a = (unit.x - myHero.x)/rastoyanie * RENEKTON_VARS.E.RANGE + myHero.x
      local b = (unit.z - myHero.z)/rastoyanie * RENEKTON_VARS.E.RANGE + myHero.z
      CastSpell(_E, a, b)
    end
  end
  if rastoyanie < RENEKTON_VARS.E.RANGE*1.85 and myHero:GetSpellData(_E).name ~= "RenektonDice" then
    local rasta = GetRastoyanie(myHero, unit) 
    local minionFocus = nil
    for _, minion in pairs(minionManager(MINION_ENEMY, RENEKTON_VARS.E.RANGE, myHero, MINION_SORT_HEALTH_ASC).objects) do
      if isValid(minion, RENEKTON_VARS.E.RANGE) then
        local rastaA = GetRastoyanie(unit, minion)
        if rasta > rastaA then
          rasta = rastaA
          minionFocus = minion
        end
      end
    end
    if minionFocus ~= nil then
      local a = (minionFocus.x - myHero.x)/rastoyanie * RENEKTON_VARS.E.RANGE + myHero.x
      local b = (minionFocus.z - myHero.z)/rastoyanie * RENEKTON_VARS.E.RANGE + myHero.z
      local dibilBlyat = Vector(a, myHero.y, b)
      if GetRastoyanie(unit, dibilBlyat) <= GetRastoyanie(myHero, unit) then
        CastSpell(_E, a, b)
      end
    end
  end
end

function Renekton_Clear()
  if CanCast(_E) and Menu.Farm.Laneclear.laneclearE then
    local CastPosition1, NumHit1 = GetBestLineFarmPosition(RENEKTON_VARS.E.RANGE, RENEKTON_VARS.E.WIDTH, minionManager(MINION_ENEMY, RENEKTON_VARS.E.RANGE, myHero, MINION_SORT_HEALTH_ASC).objects)
    if CastPosition1 ~= nil then
      CastSpell(_E, CastPosition1.x, CastPosition1.z)
    end
    local CastPositionJgl2, NumHitJgl2 = GetBestLineFarmPosition(RENEKTON_VARS.E.RANGE, RENEKTON_VARS.E.WIDTH, minionManager(MINION_JUNGLE, RENEKTON_VARS.E.RANGE, myHero, MINION_SORT_MAXHEALTH_DEC).objects)
    if CastPositionJgl2 ~= nil then
      CastSpell(_E, CastPositionJgl2.x, CastPositionJgl2.z)
    end
  end
  if CanCast(_Q) and Menu.Farm.Laneclear.laneclearQ then
    for _, minion in pairs(minionManager(MINION_ENEMY, RENEKTON_VARS.Q.RADIUS, myHero, MINION_SORT_HEALTH_ASC).objects) do
      if isValid(minion, RENEKTON_VARS.Q.RADIUS) then
        Renekton_CastQ()
      end
    end
    for _, minion in pairs(minionManager(MINION_JUNGLE, RENEKTON_VARS.Q.RADIUS, myHero, MINION_SORT_MAXHEALTH_DEC).objects) do
      if isValid(minion, RENEKTON_VARS.Q.RADIUS) then
        Renekton_CastQ()
      end
    end
  end
end

function Renekton_Lasthit()
  if CanCast(_Q) and Menu.Farm.Lasthit.lasthitQ then
    for _, minion in pairs(minionManager(MINION_ENEMY, RENEKTON_VARS.Q.RANGE, myHero, MINION_SORT_HEALTH_ASC).objects) do
      local QDmg = Renekton_GetQDamage(minion)
      if isValid(minion) and QDmg >= minion.health then
        Renekton_CastQ()
      end
    end
  end
end

function Renekton_AutoR()
  if not CanCast(_R) or not Menu.Auto.autoR then return end
  if ((myHero.health*100)/myHero.maxHealth) <= Menu.Auto.autoRHealth and ATTACKED then
    Renekton_CastR()
  end
end

function Renekton_CastQ()
  CastSpell(_Q)
end

function Renekton_CastW()
  CastSpell(_W)
end

function Renekton_CastR()
  CastSpell(_R)
end

function Renekton_GetQDamage(unit)
  if myHero.mana >= 50 then
    
    local Qlvl = myHero:GetSpellData(_Q).level
    if Qlvl < 1 then return 0 end
    local QDmg = {90, 135, 180, 225, 270}
    local DmgRaw = QDmg[Qlvl] + ((myHero.totalDamage - myHero.damage)*1.2)
    local Dmg = myHero:CalcDamage(unit, DmgRaw)
    return Dmg
  else
    
    local Qlvl = myHero:GetSpellData(_Q).level
    if Qlvl < 1 then return 0 end
    local QDmg = {60, 90, 120, 150, 180}
    local DmgRaw = QDmg[Qlvl] + ((myHero.totalDamage - myHero.damage)*0.8)
    local Dmg = myHero:CalcDamage(unit, DmgRaw)
    return Dmg
  end 
end

function Renekton_GetEDamage(unit)
  
  local Elvl = myHero:GetSpellData(_E).level
  if Elvl < 1 then return 0 end
  local EDmg = {30, 60, 90, 120, 150}
  local DmgRaw = EDmg[Elvl] + ((myHero.totalDamage - myHero.damage)*0.9)
  local Dmg = myHero:CalcDamage(unit, DmgRaw)
  return Dmg
end

function Renekton_GetWDamage(unit)
  if myHero.mana >= 50 then
    
    local Wlvl = myHero:GetSpellData(_W).level
    if Wlvl < 1 then return 0 end
    local WDmg = {15, 45, 75, 105, 135}
    local WDmgMod = 2.25
    local DmgRaw = WDmg[Wlvl] + myHero.totalDamage * WDmgMod
    local Dmg = myHero:CalcDamage(unit, DmgRaw)
    return Dmg
  else
    
    local Wlvl = myHero:GetSpellData(_W).level
    if Wlvl < 1 then return 0 end
    local WDmg = {10, 30, 50, 70, 90}
    local WDmgMod = 1.5
    local DmgRaw = WDmg[Wlvl] + myHero.totalDamage * WDmgMod
    local Dmg = myHero:CalcDamage(unit, DmgRaw)
    return Dmg
  end
end

function Renekton_DrawHP()
  for i, HPbarEnemyChamp in pairs(GetEnemyHeroes()) do
    if not HPbarEnemyChamp.dead and HPbarEnemyChamp.visible then
      local dmg = myHero:CalcDamage(HPbarEnemyChamp, myHero.totalDamage)
      if myHero:CanUseSpell(_Q) == READY and not HPbarEnemyChamp.dead then
        dmg = dmg + Renekton_GetQDamage(HPbarEnemyChamp)
      end
      if CanCast(_W) then
        dmg = dmg + Renekton_GetWDamage(HPbarEnemyChamp)
      end
      if myHero:CanUseSpell(_E) == READY and not HPbarEnemyChamp.dead then
        dmg = dmg + Renekton_GetEDamage(HPbarEnemyChamp)
      end
      DrawLineHPBar(dmg, "", HPbarEnemyChamp, HPbarEnemyChamp.team)
    end
  end
end


function Jarvan_Load()
  require "VPrediction"
  VP = VPrediction()
  CATACLYSM = false

  AddProcessAttackCallback(Jarvan_ProcessAttack)

  JARVAN_VARS = {
    AA = {RANGE = 175},
    Q = {RANGE = 770, WIDTH = 70, DELAY = 0.5, SPEED = math.huge},
    W = {RADIUS = 300},
    E = {RANGE = 830-60, DELAY = 0.5, SPEED = math.huge, RADIUS = 50},
    R = {RANGE = 650, RADIUS = 325}
  }

  YOLO = {}

  FAKER = {["AkaliMota"] = {delay = 0.1, ult = false, tricky = false},
  ["Headbutt"] = {delay = 0.1, ult = false, tricky = false},
  ["CaitlynAceintheHole"] = {delay = 1, ult = false, tricky = true},
  ["Feast"] = {delay = 0.1, ult = true, tricky = false},
  ["DariusExecute"] = {delay = 0.1, ult = true, tricky = true},
  ["VolibearW"] = {delay = 0.1, ult = false, tricky = false},
  ["GarenR"] = {delay = 0.1, ult = true, tricky = false},
  ["JudicatorReckoning"] = {delay = 0.1, ult = false, tricky = false},
  ["DianaTeleport"] = {delay = 0.1, ult = false, tricky = false},
  ["Terrify"] = {delay = 0, ult = false, tricky = true},
  ["FiddlesticksDarkWind"] = {delay = 0.1, ult = false, tricky = false},
  ["TristanaR"] = {delay = 0.1, ult = false, tricky = false},
  ["TristanaE"] = {delay = 0.1, ult = false, tricky = false},
  ["KhazixQ"] = {delay = 0.1, ult = false, tricky = false},
  ["LuluWTwo"] = {delay = 0.1, ult = false, tricky = true},
  ["khazixqlong"] = {delay = 0.1, ult = false, tricky = false},
  ["TwoShivPoison"] = {delay = 0.1, ult = false, tricky = false},
  ["BlindMonkRKick"] = {delay = 0.1, ult = false, tricky = true},
  ["AlZaharNetherGrasp"] = {delay = 0, ult = false, tricky = true},
  ["LissandraR"] = {delay = 0.1, ult = true, tricky = true},
  ["MaokaiUnstableGrowth"] = {delay = 0.1, ult = false, tricky = true},
  ["MordekaiserChildrenOfTheGrave"] = {delay = 0, ult = false, tricky = false},
  ["NasusW"] = {delay = 0.1, ult = false, tricky = false},
  ["NocturneUnspeakableHorror"] = {delay = 0, ult = false, tricky = false},
  ["IceBlast"] = {delay = 0.1, ult = false, tricky = false},
  ["OlafRecklessStrike"] = {delay = 0.1, ult = false, tricky = false},
  ["PantheonW"] = {delay = 0.1, ult = false, tricky = true},
  ["PuncturingTaunt"] = {delay = 0, ult = false, tricky = false},
  ["RyzeW"] = {delay = 0, ult = false, tricky = true},
  ["BrandWildfire"] = {delay = 0.1, ult = false, tricky = false},
  ["Fling"] = {delay = 0, ult = false, tricky = false},
  ["SkarnerImpale"] = {delay = 0.1, ult = false, tricky = true},
  ["IreliaEquilibriumStrike"] = {delay = 0.1, ult = false, tricky = true},
  ["JayceThunderingBlow"] = {delay = 0, ult = false, tricky = false},
  ["LeblancChaosOrb"] = {delay = 0.1, ult = false, tricky = true},
  ["LeblancChaosOrbM"] = {delay = 0.1, ult = false, tricky = false},
  ["tahmkenchw"] = {delay = 0.1, ult = false, tricky = false},
  ["SyndraR"] = {delay = 0.1, ult = false, tricky = false},
  ["Dazzle"] = {delay = 0.1, ult = false, tricky = false},
  ["BlindingDart"] = {delay = 0.1, ult = false, tricky = false},
  ["bluecardpreattack"] = {delay = 0.1, ult = false, tricky = false},
  ["redcardpreattack"] = {delay = 0.1, ult = false, tricky = false},
  ["VayneCondemn"] = {delay = 0.1, ult = false, tricky = true},
  ["VeigarPrimordialBurst"] = {delay = 0.1, ult = true, tricky = false},
  ["InfiniteDuress"] = {delay = 0, ult = false, tricky = false},
  ["zedult"] = {delay = 0.74, ult = true, tricky = false},
  ["Parley"] = {delay = 0.1, ult = false, tricky = false},
  ["KarthusFallenOne"] = {delay = 2.5, ult = false, tricky = true},
  ["Disintegrate"] = {delay = 0.1, ult = false, tricky = false},
  ["ViR"] = {delay = 0.1, ult = false, tricky = true}
  }

  Menu.Key:addParam("combo", "Combo", SCRIPT_PARAM_ONKEYDOWN, false, string.byte(" "))
  Menu.Key:addParam("harras", "Harras", SCRIPT_PARAM_ONKEYDOWN, false, string.byte("C"))
  Menu.Key:addParam("lasthit", "Lasthit", SCRIPT_PARAM_ONKEYDOWN, false, string.byte("X"))
  Menu.Key:addParam("laneclear", "Laneclear/Jungleclear", SCRIPT_PARAM_ONKEYDOWN, false, string.byte("V"))
  Menu.Key:addParam("flee", "Flee", SCRIPT_PARAM_ONKEYDOWN, false, string.byte("Z"))

  Menu.Combo:addParam("useEQ", "Use EQ", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("rangeEQ", "Dont use EQ in close range", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("saveEQ", "Force save EQ", SCRIPT_PARAM_ONOFF, false)
  Menu.Combo:addParam("useQ", "Use Q", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("useW", "Use W", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("useE", "Use E", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("useR", "Use R", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("burstR", "Use Burst R", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addSubMenu("[R whitelist]", "whitelistR")
  for i,enemy in pairs(GetEnemyHeroes()) do
    table.insert(YOLO, enemy.charName)
  end
  for i = 1, #YOLO do
    local a1 = "a"..i
    local a2 = ""..YOLO[i]
    Menu.Combo.whitelistR:addParam(a1, "Cast R on "..a2, SCRIPT_PARAM_ONOFF, true)
  end

  Menu.Harras:addParam("useEQ", "Use EQ", SCRIPT_PARAM_ONOFF, true)
  Menu.Harras:addParam("rangeEQ", "Dont use EQ in close range", SCRIPT_PARAM_ONOFF, true)
  Menu.Harras:addParam("saveEQ", "Force save EQ", SCRIPT_PARAM_ONOFF, false)
  Menu.Harras:addParam("useQ", "Use Q", SCRIPT_PARAM_ONOFF, true)
  Menu.Harras:addParam("useW", "Use W", SCRIPT_PARAM_ONOFF, true)
  Menu.Harras:addParam("useE", "Use E", SCRIPT_PARAM_ONOFF, true)

  Menu.Farm:addSubMenu("[Lasthit]", "Lasthit")
  Menu.Farm.Lasthit:addParam("lasthitQ", "Use Q for lasthit", SCRIPT_PARAM_ONOFF, true)
  Menu.Farm.Lasthit:addParam("lasthitQmana", "% Mana for lasthit", SCRIPT_PARAM_SLICE, 60, 0, 100, 0)
  Menu.Farm:addSubMenu("[Clear]", "Laneclear")
  Menu.Farm.Laneclear:addParam("laneclearQ", "Use Q for clear", SCRIPT_PARAM_ONOFF, true)
  Menu.Farm.Laneclear:addParam("laneclearMana", "% Mana for clear", SCRIPT_PARAM_SLICE, 50, 0, 100, 0)

  Menu.Draws:addParam("drawQ", "Draw Q range", SCRIPT_PARAM_ONOFF, true)
  Menu.Draws:addParam("drawE", "Draw E range", SCRIPT_PARAM_ONOFF, false)
  Menu.Draws:addParam("drawR", "Draw R range", SCRIPT_PARAM_ONOFF, false)
  Menu.Draws:addParam("drawHP", "Draw damage on HP bars", SCRIPT_PARAM_ONOFF, true)

  Menu.KS:addParam("ksQ", "Use Q for killsteal", SCRIPT_PARAM_ONOFF, true)
  Menu.KS:addParam("ksE", "Use E for killsteal", SCRIPT_PARAM_ONOFF, true)
  Menu.KS:addParam("ksR", "Use R for killsteal", SCRIPT_PARAM_ONOFF, true)
end

function Jarvan_Tick()
  if FOCUSED ~= nil then
    if FOCUSED.dead or not FOCUSED.visible then
      FOCUSED = nil
    end
  end
  
  if Menu.Key.combo then
    Jarvan_Combo()
  end
  
  if Menu.Key.harras then
    Jarvan_Harras()
  end
  
  if Menu.Key.lasthit then
    Jarvan_Lasthit()
  end
  
  if Menu.Key.laneclear then
    Jarvan_Clear()
  end
  
  Jarvan_Killsteal()
  
  if Menu.Key.flee then
    Jarvan_Flee()
  end
end



function Jarvan_Combo()
  if CanCast(_E) and CanCast(_Q) and Menu.Combo.useEQ then
    local target = GetHentaiTarget(JARVAN_VARS.E.RANGE)
    if target ~= nil then
      if Menu.Combo.rangeEQ then
        if GetRastoyanie(myHero, target) <= 300 then
          if TITANIC and CanCast(_R) then
            CastTITANIC()
          end
          Jarvan_CastQ(target)
        else
          if TITANIC and CanCast(_R) then
            CastTITANIC()
          end
          Jarvan_CastEQ(target)
        end
      else
        if TITANIC and CanCast(_R) then
          CastTITANIC()
        end
        Jarvan_CastEQ(target)
      end
    end
  end
  if CanCast(_Q) and Menu.Combo.rangeEQ and Menu.Combo.useQ then
    local target = GetHentaiTarget(JARVAN_VARS.Q.RANGE)
    if target ~= nil then
      if GetRastoyanie(myHero, target) <= 300 then
        Jarvan_CastQ(target)
      end
    end
  end
  if CanCast(_Q) and (not Menu.Combo.saveEQ or not CanCast(_E)) and Menu.Combo.useQ then
    local target = GetHentaiTarget(JARVAN_VARS.Q.RANGE)
    if target ~= nil then
      Jarvan_CastQ(target)
    end
  end
  if CanCast(_W) and Menu.Combo.useW then
    local target = GetHentaiTarget(JARVAN_VARS.W.RADIUS)
    if target ~= nil then
      if GetRastoyanie(myHero, target) <= JARVAN_VARS.W.RADIUS then
        Jarvan_CastW() 
      end
    end
  end
  if CanCast(_R) and Menu.Combo.useR and not CATACLYSM and Menu.Combo.burstR then
    local target = GetHentaiTarget(JARVAN_VARS.R.RANGE)
    if target ~= nil then
      if isWhitelistedforR(target) then
        Jarvan_CastR(target)
      end
    end
  end
  if Menu.Item.UseItem then
    local target = GetHentaiTarget(500)
    if target ~= nil then
      if GetRastoyanie(myHero, target) <= 200 then
        CastYoumu()
        CastTiamat()
      end
      CastBOTRK(target)
      CastGunblade(target)
      CastCutlass(target)
    end
  end
end


function Jarvan_Harras()
  if CanCast(_E) and CanCast(_Q) and Menu.Harras.useEQ then
    local target = GetHentaiTarget(JARVAN_VARS.E.RANGE)
    if target ~= nil then
      if Menu.Harras.rangeEQ then
        if GetRastoyanie(myHero, target) <= 300 then
          
        else
          Jarvan_CastEQ(target)
        end
      else
        Jarvan_CastEQ(target)
      end
    end
  end
  if CanCast(_Q) and Menu.Harras.rangeEQ and Menu.Harras.useQ then
    local target = GetHentaiTarget(JARVAN_VARS.Q.RANGE)
    if target ~= nil then
      if GetRastoyanie(myHero, target) <= 300 then
        Jarvan_CastQ(target)
      end
    end
  end
  if CanCast(_Q) and (not Menu.Harras.saveEQ or not CanCast(_E)) and Menu.Harras.useQ then
    local target = GetHentaiTarget(JARVAN_VARS.Q.RANGE)
    if target ~= nil then
      Jarvan_CastQ(target)
    end
  end
  if CanCast(_W) and Menu.Harras.useW then
    local target = GetHentaiTarget(JARVAN_VARS.W.RADIUS)
    if target ~= nil then
      Jarvan_CastW()
    end
  end
end


function Jarvan_Lasthit()
  if not Menu.Farm.Lasthit.lasthitQ  then return end
  if ((myHero.mana*100)/myHero.maxMana) <= Menu.Farm.Lasthit.lasthitQmana then return end 
  for _, minion in pairs(minionManager(MINION_ENEMY, JARVAN_VARS.Q.RANGE, myHero, MINION_SORT_HEALTH_ASC).objects) do
    if ValidTarget(minion, JARVAN_VARS.Q.RANGE) then
      local QDmg = Jarvan_GetQDamage(minion)
      if QDmg >= minion.health and CanCast(_Q) then
        Jarvan_CastQ(minion)
      end
    end
  end
end


function Jarvan_Clear()
  if ((myHero.mana*100)/myHero.maxMana) <= Menu.Farm.Laneclear.laneclearMana then return end
  for _, minion in pairs(minionManager(MINION_ENEMY, JARVAN_VARS.Q.RANGE, myHero, MINION_SORT_HEALTH_ASC).objects) do
    if ValidTarget(minion, JARVAN_VARS.Q.RANGE) then
      if CanCast(_Q) and Menu.Farm.Laneclear.laneclearQ then
        local CastPosition1, NumHit1 = GetBestLineFarmPosition(JARVAN_VARS.Q.RANGE, JARVAN_VARS.Q.WIDTH, minionManager(MINION_ENEMY, JARVAN_VARS.Q.RANGE, myHero, MINION_SORT_HEALTH_ASC).objects)
        if CastPosition1 ~= nil then
          CastSpell(_Q, CastPosition1.x, CastPosition1.z)
        end
      end
    end
  end
  for _, minion in pairs(minionManager(MINION_JUNGLE, JARVAN_VARS.Q.RANGE, myHero, MINION_SORT_MAXHEALTH_DEC).objects) do
    if ValidTarget(minion, JARVAN_VARS.Q.RANGE) then
      if CanCast(_Q) and Menu.Farm.Laneclear.laneclearQ then
        Jarvan_CastQ(minion)
      end
    end
  end
end


function Jarvan_Killsteal()
  for i,enemy in pairs(GetEnemyHeroes()) do
    if isValid(enemy, JARVAN_VARS.E.RANGE) and not CheckInvul(enemy) then
      local QDmg = Jarvan_GetQDamage(enemy)
      local EDmg = Jarvan_GetEDamage(enemy)
      local RDmg = Jarvan_GetRDamage(enemy)
      if CanCast(_Q) and Menu.KS.ksQ and QDmg >= enemy.health and not enemy.dead then
        Jarvan_CastQ(enemy)
      end
      if CanCast(_E) and Menu.KS.ksE and EDmg >= enemy.health and not enemy.dead then
        Jarvan_CastE(enemy)
      end
      if CanCast(_R) and Menu.KS.ksR and RDmg >= enemy.health and not enemy.dead and not CATACLYSM then
        Jarvan_CastR(enemy)
      end
    end
  end
end


function Jarvan_Flee()
  if GetRastoyanie(mousePos, myHero) > 300 then
    local a = (mousePos.x - myHero.x)/GetRastoyanie(mousePos, myHero) * 300 + myHero.x
    local b = (mousePos.z - myHero.z)/GetRastoyanie(mousePos, myHero) * 300 + myHero.z
    myHero:MoveTo(a, b)
  else
    myHero:MoveTo(mousePos.x, mousePos.z)
  end
  if CanCast(_Q) and CanCast(_E) then
    if GetRastoyanie(mousePos, myHero) > JARVAN_VARS.E.RANGE then
      local a = (mousePos.x - myHero.x)/GetRastoyanie(mousePos, myHero) * JARVAN_VARS.E.RANGE + myHero.x
      local b = (mousePos.z - myHero.z)/GetRastoyanie(mousePos, myHero) * JARVAN_VARS.E.RANGE + myHero.z
      CastSpell(_E, a, b)
      CastSpell(_Q, a, b)
    else
      CastSpell(_E, mousePos.x, mousePos.z)
      CastSpell(_Q, mousePos.x, mousePos.z)
    end
  end
end


function isWhitelistedforR(enemy)
  local index = whitelistIndex(enemy)
  if index == 1 then
    if Menu.Combo.whitelistR.a1 then
      return true
    else
      return false
    end
  end
  if index == 2 then
    if Menu.Combo.whitelistR.a2 then
      return true
    else
      return false
    end
  end
  if index == 3 then
    if Menu.Combo.whitelistR.a3 then
      return true
    else
      return false
    end
  end
  if index == 4 then
    if Menu.Combo.whitelistR.a4 then
      return true
    else
      return false
    end
  end
  if index == 5 then
    if Menu.Combo.whitelistR.a5 then
      return true
    else
      return false
    end
  end
end

function whitelistIndex(enemy)
  for i = 1, #YOLO do
    if enemy.charName == YOLO[i] then
      return i
    end
  end
end


function Jarvan_GetQDamage(unit)
  
  local Qlvl = myHero:GetSpellData(_Q).level
  if Qlvl < 1 then return 0 end
  local QDmg = {70, 115, 160, 205, 250}
  local bonusAD = myHero.totalDamage - myHero.damage
  local QDmgMod = 1.2
  local DmgRaw = QDmg[Qlvl] + bonusAD * QDmgMod
  local Dmg = myHero:CalcDamage(unit, DmgRaw)
  return Dmg
end

function Jarvan_GetEDamage(unit)
  
  local Elvl = myHero:GetSpellData(_E).level
  if Elvl < 1 then return 0 end
  local EDmg = {60, 105, 150, 195, 240}
  local EDmgMod = 0.8
  local DmgRaw = EDmg[Elvl] + myHero.ap * EDmgMod
  local Dmg = myHero:CalcMagicDamage(unit, DmgRaw)
  return Dmg
end

function Jarvan_GetRDamage(unit)
  
  local Rlvl = myHero:GetSpellData(_R).level
  if Rlvl < 1 then return 0 end
  local RDmg = {200, 325, 450}
  local RDmgMod = 1.5
  local DmgRaw = RDmg[Rlvl] + myHero.totalDamage * RDmgMod
  local Dmg = myHero:CalcDamage(unit, DmgRaw)
  return Dmg
end


function Jarvan_CastQ(unit)
  if unit == nil then
    return
  end
  local CastPosition, HitChance = VP:GetLineCastPosition(unit, JARVAN_VARS.Q.DELAY, JARVAN_VARS.Q.WIDTH, JARVAN_VARS.Q.RANGE, JARVAN_VARS.Q.SPEED, myHero, false)
  if HitChance >= 2 then
    CastSpell(_Q, CastPosition.x, CastPosition.z)
  end
end

function Jarvan_CastW()
  CastSpell(_W)
end

function Jarvan_CastE(unit)
  if unit == nil then
    return
  end
  local CastPosition, HitChance = VP:GetCircularCastPosition(unit, JARVAN_VARS.E.DELAY, JARVAN_VARS.E.RADIUS, JARVAN_VARS.E.RANGE, JARVAN_VARS.E.SPEED, myHero, false)
  if HitChance >= 2 then
    CastSpell(_E, CastPosition.x, CastPosition.z)
  end
end

function Jarvan_CastEQ(unit)
  if unit == nil then
    return
  end
  local CastPosition, HitChance = VP:GetCircularCastPosition(unit, JARVAN_VARS.E.DELAY, JARVAN_VARS.E.RADIUS, JARVAN_VARS.E.RANGE, JARVAN_VARS.E.SPEED, myHero, false)
  if HitChance >= 2 then
    local rastoyanie = GetRastoyanie(myHero, CastPosition)
    local a = (CastPosition.x - myHero.x)/rastoyanie * (rastoyanie + 50) + myHero.x
    local b = (CastPosition.z - myHero.z)/rastoyanie * (rastoyanie + 50) + myHero.z
    if CanCast(_R) then
      CastTITANIC()
    end
    CastSpell(_E, a, b)
    CastSpell(_Q, a, b)
  end
end

function Jarvan_CastR(unit)
  if unit ~= nil then
    CastSpell(_R, unit)
  end
end


function Jarvan_DrawHPbar()
  for i, HPbarEnemyChamp in pairs(GetEnemyHeroes()) do
    if not HPbarEnemyChamp.dead and HPbarEnemyChamp.visible then
      local dmg = myHero:CalcDamage(HPbarEnemyChamp, myHero.totalDamage)
      if myHero:CanUseSpell(_Q) == READY and not HPbarEnemyChamp.dead then
        dmg = dmg + Jarvan_GetQDamage(HPbarEnemyChamp)
      end
      if myHero:CanUseSpell(_R) == READY and not HPbarEnemyChamp.dead then
        dmg = dmg + Jarvan_GetRDamage(HPbarEnemyChamp)
      end
      if myHero:CanUseSpell(_E) == READY and not HPbarEnemyChamp.dead then
        dmg = dmg + Jarvan_GetEDamage(HPbarEnemyChamp)
      end
      DrawLineHPBar(dmg, "", HPbarEnemyChamp, HPbarEnemyChamp.team)
    end
  end
end


function Jarvan_Draw()
  if Menu.Draws.drawQ then
    DrawFPSCircle(myHero.x, myHero.z, JARVAN_VARS.Q.RANGE, ARGB(255,225,255,255), 4)
  end
  if Menu.Draws.drawE then
    DrawFPSCircle(myHero.x, myHero.z, JARVAN_VARS.E.RANGE, ARGB(255,255,255,255), 4)
  end
  if Menu.Draws.drawR then
    DrawFPSCircle(myHero.x, myHero.z, JARVAN_VARS.R.RANGE, ARGB(255,255,255,255), 4)
  end
  if Menu.Draws.drawHP then
    Jarvan_DrawHPbar()
  end
end



function Jarvan_OnProcessSpell(unit, spell)
  if spell ~= nil and spell.target ~= nil and unit ~= nil then
    if FAKER[spell.name] ~= nil and spell.target.isMe and CanCast(_W) then
      Jarvan_CastW()
    end
  end
end


function Jarvan_OnCreateObj(obj)
  if obj ~= nil then
    if obj.name == "JarvanIVWall" then
      CATACLYSM = true
    end
  end
end

function Jarvan_OnDeleteObj(obj)
  if obj ~= nil then
    if obj.name == "JarvanIVWall" then
      CATACLYSM = false
    end
  end
end


function Jarvan_ProcessAttack(unit, spell)
  if unit == myHero and isAutoAttack(spell.name) and spell.target and spell.target.type ~= myHero.type and Menu.Key.laneclear then
    local AADmg = myHero:CalcDamage(spell.target, myHero.totalDamage)
    local reseted = false
    if AADmg < spell.target.health and TITANIC and not reseted then
      if CanCast(TITANICSLOT) then
        CastTITANIC()
        if SAC then
          _G.AutoCarry.MyHero:MovementEnabled(false)
          _G.AutoCarry.MyHero:AttacksEnabled(false)
          myHero:Attack(spell.target)
          DelayAction(function()
            _G.AutoCarry.MyHero:MovementEnabled(true)
            _G.AutoCarry.MyHero:AttacksEnabled(true)
          end, 0.1)
        end
        reseted = true
      end
    end
  end
  if unit == myHero and isAutoAttack(spell.name) and spell.target and spell.target.type == myHero.type and Menu.Key.combo then
    local reseted = false
    local AADmg = myHero:CalcDamage(spell.target, myHero.totalDamage)
    if Menu.Combo.useR and isWhitelistedforR(spell.target) then
      Jarvan_CastR(spell.target)
    end
    if AADmg < spell.target.health and TITANIC and not reseted then
      if CanCast(TITANICSLOT) then
        CastTITANIC()
        if SAC then
          _G.AutoCarry.MyHero:MovementEnabled(false)
          _G.AutoCarry.MyHero:AttacksEnabled(false)
          myHero:Attack(spell.target)
          DelayAction(function()
            _G.AutoCarry.MyHero:MovementEnabled(true)
            _G.AutoCarry.MyHero:AttacksEnabled(true)
          end, 0.1)
        end
        reseted = true
      end
    end
  end
  if unit == myHero and isAutoAttack(spell.name) and spell.target and spell.target.type == myHero.type and Menu.Key.harras then
    local reseted = false
    local AADmg = myHero:CalcDamage(spell.target, myHero.totalDamage)
    if AADmg < spell.target.health and TITANIC and not reseted then
      if CanCast(TITANICSLOT) then
        CastTITANIC()
        if SAC then
          _G.AutoCarry.MyHero:MovementEnabled(false)
          _G.AutoCarry.MyHero:AttacksEnabled(false)
          myHero:Attack(spell.target)
          DelayAction(function()
            _G.AutoCarry.MyHero:MovementEnabled(true)
            _G.AutoCarry.MyHero:AttacksEnabled(true)
          end, 0.1)
        end
        reseted = true
      end
    end
  end
end


function Talon_Load()

	require "VPrediction"
	VP = VPrediction()

	AddProcessAttackCallback(Talon_ProcessAttack)

	ATTACKQ = false
	ULTPOS = nil
	TALON_VARS = {
	  AA = {RANGE = 575},
	  W = {RANGE = 650, SPEED = 2300, DELAY = 0.25, WIDTH = 75},
	  E = {RANGE = 700},
	  R = {RADIUS = 600}
	}

	Menu.Key:addParam("combo", "Combo", SCRIPT_PARAM_ONKEYDOWN, false, string.byte(" "))
  Menu.Key:addParam("harras", "Harras", SCRIPT_PARAM_ONKEYDOWN, false, string.byte("C"))
  Menu.Key:addParam("lasthit", "Lasthit", SCRIPT_PARAM_ONKEYDOWN, false, string.byte("X"))
  Menu.Key:addParam("laneclear", "Laneclear/Jungleclear", SCRIPT_PARAM_ONKEYDOWN, false, string.byte("V"))

 	Menu.Combo:addParam("useQ", "Use Q", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("useW", "Use W", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("useE", "Use E", SCRIPT_PARAM_ONOFF, true)
  Menu.Combo:addParam("useR", "Use R", SCRIPT_PARAM_ONOFF, true)

  Menu.Harras:addParam("useQ", "Use Q", SCRIPT_PARAM_ONOFF, true)
  Menu.Harras:addParam("useW", "Use W", SCRIPT_PARAM_ONOFF, true)
  Menu.Harras:addParam("useE", "Use E", SCRIPT_PARAM_ONOFF, true)
  Menu.Harras:addParam("harrasMana", "% Mana for harras", SCRIPT_PARAM_SLICE, 50, 0, 100, 0)

  Menu.Farm:addSubMenu("[Lasthit]", "Lasthit")
  Menu.Farm.Lasthit:addParam("lasthitQ", "Use Q for lasthit", SCRIPT_PARAM_ONOFF, true)
  Menu.Farm.Lasthit:addParam("lasthitQmana", "% Mana for lasthit", SCRIPT_PARAM_SLICE, 60, 0, 100, 0)
  Menu.Farm:addSubMenu("[Clear]", "Laneclear")
  Menu.Farm.Laneclear:addParam("laneclearQ", "Use Q for clear", SCRIPT_PARAM_ONOFF, true)
  Menu.Farm.Laneclear:addParam("laneclearW", "Use W for clear", SCRIPT_PARAM_ONOFF, true)
  Menu.Farm.Laneclear:addParam("laneclearMana", "% Mana for clear", SCRIPT_PARAM_SLICE, 30, 0, 100, 0)
  Menu.Farm:addSubMenu("[Jungle Clear]", "JLaneclear")
  Menu.Farm.JLaneclear:addParam("laneclearQ", "Use Q for clear", SCRIPT_PARAM_ONOFF, true)
  Menu.Farm.JLaneclear:addParam("laneclearW", "Use W for clear", SCRIPT_PARAM_ONOFF, true)
  Menu.Farm.JLaneclear:addParam("laneclearMana", "% Mana for clear", SCRIPT_PARAM_SLICE, 30, 0, 100, 0)

  Menu.Draws:addParam("drawW", "Draw W range", SCRIPT_PARAM_ONOFF, false)
  Menu.Draws:addParam("drawE", "Draw E range", SCRIPT_PARAM_ONOFF, true)
  Menu.Draws:addParam("drawR", "Draw R range", SCRIPT_PARAM_ONOFF, false)
  Menu.Draws:addParam("drawHP", "Draw damage on HP bars", SCRIPT_PARAM_ONOFF, true)

  Menu.KS:addParam("ksQ", "Use Q for killsteal", SCRIPT_PARAM_ONOFF, true)
  Menu.KS:addParam("ksW", "Use W for killsteal", SCRIPT_PARAM_ONOFF, true)
  Menu.KS:addParam("ksE", "Use E for killsteal", SCRIPT_PARAM_ONOFF, true)
  Menu.KS:addParam("ksR1", "Use R1 for killsteal", SCRIPT_PARAM_ONOFF, true)
  Menu.KS:addParam("ksR2", "Use R2 for killsteal", SCRIPT_PARAM_ONOFF, true)
end

function Talon_Tick()
	if FOCUSED ~= nil then
    if FOCUSED.dead or not FOCUSED.visible then
      FOCUSED = nil
    end
  end
  
  Talon_Killsteal()
  
  if Menu.Key.combo then
    Talon_Combo()
  end
  
  if Menu.Key.harras then
    Talon_Harras()
  end
  
  if Menu.Key.lasthit then
    Talon_Lasthit()
  end
  
  if Menu.Key.laneclear then
    Talon_Laneclear()
  end
end

function Talon_Draw()
	if not myHero.dead then
    if Menu.Draws.drawW then
      DrawFPSCircle(myHero.x, myHero.z, TALON_VARS.W.RANGE, ARGB(255,255,128,0), 3)
    end
    if Menu.Draws.drawE then
      DrawFPSCircle(myHero.x, myHero.z, TALON_VARS.E.RANGE, ARGB(255,255,128,0), 3)
    end
    if Menu.Draws.drawR then
      DrawFPSCircle(myHero.x, myHero.z, TALON_VARS.R.RADIUS, ARGB(255,255,128,0), 3)
    end
    if Menu.Draws.drawTarget then
      DrawSelectedTarget()
    end
    if Menu.Draws.drawHP then
      DrawHP()
    end
  end
end


function DrawHP()
  for i, enemy in pairs(GetEnemyHeroes()) do
    if enemy.visible and not enemy.dead then
      local totalDMG = 0  
      local dmg = myHero:CalcDamage(enemy, myHero.totalDamage)
      totalDMG = totalDMG + dmg
      if CanCast(_Q) then
        totalDMG = totalDMG + Talon_GetQDamage(enemy)
      end
      if CanCast(_W) then
        totalDMG = totalDMG + Talon_GetWDamage(enemy)
      end
      if CanCast(_R) then
        totalDMG = totalDMG + 2*Talon_GetRDamage(enemy)
      end
      DrawLineHPBar(totalDMG+totalDMG*0.13, "", enemy, enemy.team)
    end
  end
end


function Talon_Killsteal()
  for i,enemy in pairs(GetEnemyHeroes()) do
    if not CheckInvul(enemy) then
      local rastoyanie = GetRastoyanie(myHero, enemy)
      if (ValidTarget(enemy, TALON_VARS.E.RANGE)) then
        local QDmg = Talon_GetQDamage(enemy)
        local WDmg = Talon_GetWDamage(enemy)
        local RDmg = Talon_GetRDamage(enemy)
        if rastoyanie <= TALON_VARS.W.RANGE and WDmg >= enemy.health and Menu.KS.ksW and CanCast(_W) then
          Talon_CastW(enemy)
        end
        if rastoyanie <= 200 and CanCast(_Q) and QDmg >= enemy.health and Menu.KS.ksQ then
          Talon_CastQ()
        end
        if rastoyanie <= TALON_VARS.R.RADIUS and RDmg >= enemy.health and Menu.KS.ksR1 and not TargetHaveBuff("talonshadowassaultbuff", myHero) and CanCast(_R) then
          Talon_CastR()
        end
        if ULTPOS then
          if GetRastoyanie(ULTPOS, enemy) <= (TALON_VARS.R.RADIUS+50) and RDmg >= enemy.health and Menu.KS.ksR2 and TargetHaveBuff("talonshadowassaultbuff", myHero) and CanCast(_R) then
            Talon_CastR()
          end
        end
      end
    end
  end
end


function Talon_Combo()
  local target = GetHentaiTarget(TALON_VARS.E.RANGE)
  if target then
    if not CanCast(_E) and GetRastoyanie(myHero, target) > 250 then
      if CanCast(_W) and Menu.Combo.useW then
        Talon_CastW(target)
      end
      if CanCast(_R) and Menu.Combo.useR and not TargetHaveBuff("talonshadowassaultbuff", myHero) then
        Talon_CastR()
      end
    end
    if GetRastoyanie(myHero, target) <= 600 then
      if CanCast(_W) and Menu.Combo.useW then
        Talon_CastW(target)
      end
      if CanCast(_E) and Menu.Combo.useE then
        Talon_CastE(target)
      end
      if Menu.Item.UseItem then
        if GetRastoyanie(myHero, target) <= 250 then
          CastYoumu()
        end
        CastBOTRK(target)
        CastGunblade(target)
        CastCutlass(target)
      end
    else
      if CanCast(_E) and Menu.Combo.useE then
        Talon_CastE(target)
      end
      if CanCast(_W) and Menu.Combo.useW then
        Talon_CastW(target)
      end
      if Menu.Item.UseItem then
        if GetRastoyanie(myHero, target) <= 250 then
          CastYoumu()
        end
        CastBOTRK(target)
        CastGunblade(target)
        CastCutlass(target)
      end
    end
  end
end


function Talon_Harras()
  if ((myHero.mana*100)/myHero.maxMana) < Menu.Harras.harrasMana then return end
  local target = GetHentaiTarget(TALON_VARS.E.RANGE)
  if target then
    if GetRastoyanie(myHero, target) <= 600 then
      if CanCast(_W) and Menu.Harras.useW then
        Talon_CastW(target)
      end
      if CanCast(_E) and Menu.Harras.useE then
        Talon_CastE(target)
      end
      if Menu.Item.UseItem then
        CastCutlass(target)
      end
    else
      if CanCast(_E) and Menu.Harras.useE then
        Talon_CastE(target)
      end
      if CanCast(_W) and Menu.Harras.useW then
        Talon_CastW(target)
      end
      if Menu.Item.UseItem then
        CastCutlass(target)
      end
    end
  end
end


function Talon_Lasthit()
  if ((myHero.mana*100)/myHero.maxMana) <= Menu.Farm.Lasthit.lasthitQmana then return end
  for _, minion in pairs(minionManager(MINION_ENEMY, 225, myHero, MINION_SORT_HEALTH_ASC).objects) do
    local QDmg = Talon_GetQDamage(minion)
    if QDmg >= minion.health and Menu.Farm.Lasthit.lasthitQ and ATTACKQ then
      Talon_CastQ()
    end
  end
end


function Talon_Laneclear()
  if ((myHero.mana*100)/myHero.maxMana) <= Menu.Farm.Laneclear.laneclearMana then return end
  if CanCast(_W) and Menu.Farm.Laneclear.laneclearW then
    local CastPosition, NumHit = GetBestLineFarmPosition(TALON_VARS.W.RANGE, TALON_VARS.W.WIDTH, minionManager(MINION_ENEMY, TALON_VARS.W.RANGE, myHero, MINION_SORT_HEALTH_ASC).objects)
    if CastPosition ~= nil then
      CastSpell(_W, CastPosition.x, CastPosition.z)
    end
  end
  if CanCast(_W) and Menu.Farm.JLaneclear.laneclearW then
    local CastPositionJgl, NumHitJgl = GetBestLineFarmPosition(TALON_VARS.W.RANGE, TALON_VARS.W.WIDTH, minionManager(MINION_JUNGLE, TALON_VARS.W.RANGE, myHero, MINION_SORT_MAXHEALTH_DEC).objects)
    if CastPositionJgl ~= nil then
      CastSpell(_W, CastPositionJgl.x, CastPositionJgl.z)
    end
  end
end


function Talon_ProcessAttack(unit,spell)
  if unit == myHero and isAutoAttack(spell.name) and spell.target and spell.target.type ~= myHero.type and Menu.Key.lasthit then
    ATTACKQ = true
    DelayAction(function() ATTACKQ = false end, 1)
  end
  if unit == myHero and isAutoAttack(spell.name) and spell.target and spell.target.type ~= myHero.type and Menu.Key.laneclear then
    local AADmg = myHero:CalcDamage(spell.target, myHero.totalDamage)
    if CanCast(_Q) and AADmg < spell.target.health and ((myHero.mana*100)/myHero.maxMana) >= Menu.Farm.Laneclear.laneclearMana then
      if Menu.Farm.Laneclear.laneclearQ then
        Talon_CastQ()
      end
    end
    if AADmg < spell.target.health and not CanCast(_Q) then
      CastTITANIC()
    end
  end
  if unit == myHero and isAutoAttack(spell.name) and spell.target and spell.target.type == myHero.type and Menu.Key.combo then
    local AADmg = myHero:CalcDamage(spell.target, myHero.totalDamage)
    if CanCast(_Q) and AADmg < spell.target.health then
      if Menu.Combo.useQ then
        Talon_CastQ()
      end
    end
    if Menu.Combo.useR and CanCast(_R) and not CanCast(_W) and not CanCast(_E) and not TargetHaveBuff("talonnoxiandiplomacybuff") then
      Talon_CastR()
    end
    if string.lower(spell.name) == "talonnoxiandiplomacyattack" then
      CastTiamat()
      if Menu.Combo.useR and CanCast(_R) then
        DelayAction(function() Talon_CastR() end, 0.5)
      end
    end
  end
  if unit == myHero and isAutoAttack(spell.name) and spell.target and spell.target.type == myHero.type and Menu.Key.harras then
    local AADmg = myHero:CalcDamage(spell.target, myHero.totalDamage)
    if CanCast(_Q) and AADmg < spell.target.health then
      if Menu.Combo.useQ then
        Talon_CastQ()
      end
    end
  end
end


function Talon_GetQDamage(unit)
  
  local Qlvl = myHero:GetSpellData(_Q).level
  if Qlvl < 1 then return 0 end
  local QDmg = {30, 60, 90, 120, 150}
  local DmgRaw = QDmg[Qlvl] + ((myHero.totalDamage - myHero.damage)*0.3) + myHero.totalDamage
  local Dmg = myHero:CalcDamage(unit, DmgRaw)
  return Dmg
end

function Talon_GetWDamage(unit)
  
   local Wlvl = myHero:GetSpellData(_W).level
  if Wlvl < 1 then return 0 end
  local WDmg = {60, 110, 160, 210, 260}
  local WDmgMod = 1.2
  local DmgRaw = WDmg[Wlvl] + (myHero.totalDamage - myHero.damage) * WDmgMod
  local Dmg = myHero:CalcDamage(unit, DmgRaw)
  return Dmg
end

function Talon_GetRDamage(unit)
  
  local Rlvl = myHero:GetSpellData(_R).level
  if Rlvl < 1 then return 0 end
  local RDmg = {120, 170, 220}
  local RDmgMod = 0.75
  local DmgRaw = RDmg[Rlvl] + (myHero.totalDamage - myHero.damage) * RDmgMod
  local Dmg = myHero:CalcDamage(unit, DmgRaw)
  return Dmg
end


function Talon_CastQ()
  CastSpell(_Q)
end

function Talon_CastW(unit)
  if VP ~= nil then
    local CastPosition, HitChance = VP:GetLineCastPosition(unit, TALON_VARS.W.DELAY, TALON_VARS.W.WIDTH, TALON_VARS.W.RANGE, TALON_VARS.W.SPEED, myHero, false)
    if HitChance >= 2 then
      CastSpell(_W, CastPosition.x, CastPosition.z)
    end
  end
end

function Talon_CastE(unit)
  CastSpell(_E, unit)
end

function Talon_CastR()
  CastSpell(_R)
end
